<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Marco Antonio Peixoto" />

<meta name="date" content="2024-01-19" />

<title>SimpleMating: A R package to breeding crosses optimization</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">SimpleMating: A R package to breeding
crosses optimization</h1>
<h4 class="author">Marco Antonio Peixoto</h4>
<h4 class="date">2024-01-19</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><strong>SimpleMating</strong> predicts cross usefulness (cross mean
and variance) and creates a mating plan based on the balancing of
usefulness and inbreeding, through optimum cross selection. It has two
modules:</p>
<ol style="list-style-type: lower-roman">
<li>Cross prediction;<br />
</li>
<li>Mating optimization.</li>
</ol>
<p>In this tutorial we will explain the implementation of both modules.
It is worth mentioning is that the prediction of usefulness is not
needed for the optimization. If only genetic values (BLUP, for example)
and a relationship matrix is given (pedigree- or marker-based
relationship matrix) for the parents, we can implement the optimization.
However, it has been shown that use usefulness may improve the genetic
gain in the long term for several crops.</p>
</div>
<div id="input-files" class="section level2">
<h2>Input files</h2>
<p>Four files are needed but not all required, to run an analyses in
<strong>SimpleMating</strong>:</p>
<ol style="list-style-type: lower-roman">
<li>Matrix with markers from the parental population;<br />
</li>
<li>markers effects for the target trait (or traits);<br />
</li>
<li>Genetic map for recombination frequency estimation;<br />
</li>
<li>relationship matrix (pedigree- or marker-based).</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># 1. Install and require the package</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># install.packages(SimpleMating)</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; Loading required package: SimpleMating</span></span></code></pre></div>
<div id="marker-matrix" class="section level4">
<h4>1) Marker matrix</h4>
<p>The marker matrix has the information of genotypes in the lines and
the information of SNPs in the columns, coded as 0,1,2 meaning the
number of copies of the alternative allele that is presented for each
loci.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Marker matrix</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">data</span>(lines_Geno)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>lines_Geno[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;    Chr1_SNP1 Chr1_SNP2 Chr1_SNP3 Chr1_SNP4 Chr1_SNP5 Chr1_SNP6 Chr1_SNP7</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; G1         0         0         2         0         2         0         0</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; G2         0         0         2         0         0         0         2</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; G3         0         0         2         0         2         0         0</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; G4         0         0         2         0         0         0         2</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; G5         0         0         2         0         0         0         2</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt;    Chr1_SNP8 Chr1_SNP9 Chr1_SNP10</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; G1         0         0          0</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; G2         2         0          0</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; G3         0         0          0</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; G4         2         0          0</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; G5         2         0          0</span></span></code></pre></div>
</div>
<div id="marker-effects" class="section level4">
<h4>2) Marker effects</h4>
<p>This is a data frame with the information of the effects for each
marker from the matrix before mentioned. In this case, each row
represents one marker and each column one trait (two traits and 1230
markers).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Marker Effects</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">data</span>(lines_addEffects)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">head</span>(lines_addEffects)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;      add_trait1    add_trait2</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 1  0.0207632801  1.034444e-03</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 2 -0.0018488022 -7.234415e-03</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 3 -0.0073807532  2.244785e-03</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 4 -0.0066209813  2.713244e-03</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 5  0.0004828055 -3.478676e-05</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 6 -0.0204069302  1.191772e-02</span></span></code></pre></div>
</div>
<div id="genetic-map" class="section level4">
<h4>3) Genetic map</h4>
<p>The genetic map is a data frame with the information about position,
in the genome, of the markers. There are three columns in the file,
being the first the chromosome, the second represents the actual
position of the marker (in centimorgan), and the third is the marker
name.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Genetic Map</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">data</span>(lines_GenMap)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">head</span>(lines_GenMap)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt;   chr         pos  mkr</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 1   1  0.07865088  1_2</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 2   1  3.64901989 1_11</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 3   1  6.60301305 1_20</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 4   1  7.04754570 1_22</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 5   1  9.34700329 1_27</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; 6   1 11.35608253 1_33</span></span></code></pre></div>
</div>
<div id="relationship-matrix" class="section level4">
<h4>4) Relationship matrix</h4>
<p>For the optimization itself, to restrict inbreeding levels, we need a
relationship matrix. It could be a numerator relationship matrix based
on pedigree data or a realized relationship matrix based on markers.</p>
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>We going to cover four examples, as follows:</p>
<ol style="list-style-type: decimal">
<li>Optimization based on usefulness for one additive trait using
molecular markers. <a href="#pt1">shortcut</a><br />
</li>
<li>Optimization based on usefulness for two additive traits using
molecular markers. <a href="#pt2">shortcut</a><br />
</li>
<li>Optimization based on usefulness for one additive/dominance trait
using molecular markers. <a href="#pt3">shortcut</a><br />
</li>
<li>Optimization based on total genetic value for one additive trait
using molecular markers. <a href="#pt4">shortcut</a><br />
</li>
<li>Optimization based on mean parental average for one additive trait
using pedigree information. <a href="#pt5">shortcut</a></li>
<li>Optimization: Using the linkage disequilibrium to predicts the cross
variance. <a href="#pt6">shortcut</a></li>
<li>Thinning by relatedness: How to increase prediction speed. <a href="#pt7">shortcut</a></li>
</ol>
<div id="pt1"></div>

</div>
<div id="optimization-usefulness-on-additive-trait" class="section level2">
<h2>Optimization: Usefulness on additive trait</h2>
<p>Here, we will create a mating plan based on usefulness for one
additive trait.</p>
<p>We need the cross plan, with all individuals candidates to be
parents. We may use the function <code>planCross()</code> for doing so.
The parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getUsefA()</code> to predict the
usefulness for each cross in the cross plan, using the markers, markers’
effects, and the genetic map. For this function, we may set the
proportion of selection individuals (<em>proSel</em>), the population
type (<em>Type</em>), and the generation (<em>Generation</em>).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># 1. Assigning the parents</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(lines_Geno)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># 2. Creating the cross plan</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co"># 3.  Usefulness of trait number 1 (DH)</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>usef_add <span class="ot">&lt;-</span> <span class="fu">getUsefA</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>                     <span class="at">Markers =</span> lines_Geno,</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>                     <span class="at">addEff =</span> lines_addEffects[, <span class="dv">1</span>],</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>                     <span class="at">Map.In =</span> lines_GenMap,</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>                     <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>                     <span class="at">Type =</span> <span class="st">&quot;DH&quot;</span>,</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>                     <span class="at">Generation =</span> <span class="dv">1</span>)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="fu">head</span>(usef_add, <span class="dv">10</span>)</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt;    Cross.ID Parent1 Parent2    Mean  Variance        sd Usefulness</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; 1     G1_G2      G1      G2 4.51880 0.1333033 0.3651072    5.27191</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; 2     G2_G3      G2      G3 4.01124 0.3056290 0.5528372    5.15158</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; 3     G2_G4      G2      G4 4.18298 0.2135113 0.4620728    5.13610</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; 4     G1_G3      G1      G3 4.10644 0.2235912 0.4728543    5.08180</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt; 5     G1_G4      G1      G4 4.27818 0.1284029 0.3583335    5.01732</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; 6     G3_G4      G3      G4 3.77061 0.3159532 0.5620971    4.93005</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt; 7     G2_G5      G2      G5 3.38943 0.3341835 0.5780861    4.58186</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="co">#&gt; 8     G1_G5      G1      G5 3.48462 0.2635954 0.5134154    4.54365</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co">#&gt; 9    G1_G30      G1     G30 3.40499 0.2795036 0.5286810    4.49551</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="co">#&gt; 10   G1_G24      G1     G24 3.09747 0.4479298 0.6692756    4.47799</span></span></code></pre></div>
<p>The second part is using criterion for each cross (usefulness in this
example) together with a relationship matrix (based on markers in this
example) and create a optimum cross selection-based mating plan. The
idea is to restrict the levels of inbreeding, by means of the covariance
in the individual-cross level, and maximize the criterion used
(usefulness in this example). There is needed to set the target number
of crosses in the mating plan (<em>n.cross</em>), with the maximum and
minimum number of crosses that each parent can be part of
(<em>max.cross</em> and <em>min.cross</em>), together with the level of
covariance between cross via relationship matrix for the restriction
(<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># 1. Creating a relationship matrix from markers</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (lines_Geno <span class="sc">%*%</span> <span class="fu">t</span>(lines_Geno)) <span class="sc">/</span> <span class="fu">ncol</span>(lines_Geno)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># 2. Generating the input for the optimization</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>MatingCrosses <span class="ot">&lt;-</span> <span class="fu">usef2Crosses</span>(<span class="at">Usefulness =</span> usef_add, <span class="at">K =</span> relMat)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># 3. Crosses selected</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> MatingCrosses[[<span class="dv">1</span>]],</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                             <span class="at">K =</span> relMat,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">10</span>,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">2</span>,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="dv">1</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y target.K</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; 1                  1 4.159017 1.070016</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; 1       G2      G3 5.15158 0.9886179</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; 2       G3      G4 4.93005 0.9821138</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; 3       G3      G5 4.34008 0.9918699</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; 4       G1     G13 4.33268 0.9788618</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; 5       G2     G24 4.32874 0.9918699</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; 6       G4     G24 4.23663 0.9463415</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; 7       G1     G10 4.19402 0.9658537</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; 8       G4     G12 3.99863 0.9886179</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; 9      G24     G30 3.13485 0.9951220</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; 10     G12     G24 2.94291 0.9886179</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="pt2"></div>

</div>
<div id="optimization-usefulness-on-multi-traits-scenario" class="section level2">
<h2>Optimization: Usefulness on Multi traits scenario</h2>
<p>Here, we will create a mating plan based on usefulness for two
additive traits.</p>
<p>We need the cross plan, with all individuals candidates to be
parents. We may use the function <code>planCross()</code> for doing so.
The parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getUsefA_mt()</code> to predict the
usefulness for each cross in the cross plan, using the markers, markers’
effects, and the genetic map. In addition, we need to set weights for
each trait (<em>Weights</em>), in a way to build a trait-based index for
the estimation of usefulness. For this function, we may set the
proportion of selection individuals (<em>proSel</em>), the population
type (<em>Type</em>), and the generation (<em>Generation</em>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># 1. Assigning the parents</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(lines_Geno)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># 2. Creating the mating plan</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co"># 3.  Usefulness for two traits</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>Multitrait_usef <span class="ot">&lt;-</span> <span class="fu">getUsefA_mt</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>                               <span class="at">Markers =</span> lines_Geno,</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>                               <span class="at">addEff =</span> lines_addEffects,</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>                               <span class="at">Map.In =</span> lines_GenMap,</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>                               <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>                               <span class="at">Type =</span> <span class="st">&quot;RIL&quot;</span>,</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>                               <span class="at">Generation =</span> <span class="dv">1</span>,</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>                               <span class="at">Weights =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="fu">head</span>(Multitrait_usef, <span class="dv">10</span>)</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt;    Cross.ID Parent1 Parent2    Mean   Variance        sd Usefulness</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; 1     G1_G2      G1      G2 2.28678 0.01126616 0.1061422    2.50572</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; 2     G2_G4      G2      G4 2.24444 0.01504070 0.1226405    2.49741</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; 3     G1_G4      G1      G4 2.24372 0.01100678 0.1049132    2.46013</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; 4     G2_G3      G2      G3 1.85493 0.03397417 0.1843208    2.23513</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; 5     G3_G4      G3      G4 1.81186 0.03789793 0.1946739    2.21342</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; 6     G1_G3      G1      G3 1.85421 0.02578186 0.1605673    2.18541</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; 7     G2_G5      G2      G5 1.77789 0.02448657 0.1564819    2.10067</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; 8     G1_G5      G1      G5 1.77717 0.02014957 0.1419492    2.06997</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; 9    G2_G12      G2     G12 1.71979 0.02859541 0.1691018    2.06860</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; 10   G2_G30      G2     G30 1.68297 0.03234579 0.1798494    2.05395</span></span></code></pre></div>
<p>The second part is using criterion for each cross (usefulness in this
example) together with a relationship matrix (based on markers in this
example) and create a optimum cross selection-based mating plan. The
idea is to restrict the levels of inbreeding, by means of the covariance
in the individual-cross level, and maximize the criterion used
(usefulness in this example). There is needed to set the target number
of crosses in the mating plan (<em>n.cross</em>), with the maximum and
minimum number of crosses that each parent can be part of
(<em>max.cross</em> and <em>min.cross</em>), together with the level of
covariance between cross via relationship matrix for the restriction
(<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># 1. Creating a relationship matrix from markers</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (lines_Geno <span class="sc">%*%</span> <span class="fu">t</span>(lines_Geno)) <span class="sc">/</span> <span class="fu">ncol</span>(lines_Geno)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># 2. Generating the input for the optimization</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>MatingCrossesMT <span class="ot">&lt;-</span> <span class="fu">usef2Crosses</span>(<span class="at">Usefulness =</span> Multitrait_usef, <span class="at">K =</span> relMat)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co"># 3. Crosses selected</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> MatingCrossesMT[[<span class="dv">1</span>]],</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>                             <span class="at">K =</span> relMat,</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">10</span>,</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">3</span>,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="dv">1</span>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y target.K</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; 1                  1 1.940074 1.098542</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="fu">head</span>(maxGainPlan[[<span class="dv">2</span>]], <span class="dv">10</span>)</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; 1       G2      G3 2.23513 0.9886179</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; 2       G3      G4 2.21342 0.9821138</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; 3       G4     G12 2.04633 0.9886179</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; 4       G4      G6 1.99178 0.9691057</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; 5       G2     G13 1.90305 0.9560976</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; 6       G1     G13 1.88016 0.9788618</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; 7       G4     G58 1.87963 0.9723577</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; 8       G2     G37 1.81394 0.9365854</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; 9       G3      G5 1.71879 0.9918699</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; 10      G1     G27 1.71851 0.9983740</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="pt3"></div>

</div>
<div id="optimization-usefulness-and-additivenon-additive-effects" class="section level2">
<h2>Optimization: Usefulness and additive/non-additive effects</h2>
<p>Here, we will create a mating plan based on usefulness for a trait
with additive and dominance effects.</p>
<p>We need the cross plan, with all individuals candidates to be
parents. We may use the function <code>planCross()</code> for doing so.
The parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getUsefAD()</code> to predict the
usefulness for each cross in the cross plan, using the markers, markers’
effects (additive marker effects and dominance marker effects), and the
genetic map. For this function, we may set the proportion of selection
individuals (<em>proSel</em>), the population type (<em>Type</em>), and
the generation (<em>Generation</em>).</p>
<p>There are two options for prediction of usefulness implemented in
<strong>SimpleMating</strong>. One of them are based on phased
haplotypes (basically a marker set where we know from each chromosome
the copy of the allele came from) (<em>Method = Phased</em>). The method
is a proposition that we implemented to estimate the usefulness without
the need for phased haplotypes (<em>Method = NonPhased</em>).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Loading the data</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">data</span>(generic_GenMap)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">data</span>(generic_Geno)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">data</span>(generic_MrkEffects)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">data</span>(generic_Phasedgeno)</span></code></pre></div>
<p>Implementation</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># 1. Assigning the parents</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(generic_Geno)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># 2. Creating the mating plan</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># 3.  Usefulness of trait number 1 - Phased</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>usef_Phased <span class="ot">&lt;-</span> <span class="fu">getUsefAD</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>                       <span class="at">Markers =</span> generic_Phasedgeno, <span class="co"># Phased haplotypes</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>                       <span class="at">addEff =</span> generic_MrkEffects[, <span class="dv">1</span>],</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>                       <span class="at">domEff =</span> generic_MrkEffects[, <span class="dv">3</span>],</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>                       <span class="at">Map.In =</span> generic_GenMap,</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>                       <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>                       <span class="at">Method =</span> <span class="st">&quot;Phased&quot;</span>)</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="fu">head</span>(usef_Phased, <span class="dv">10</span>)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt;       Cross.ID Parent1 Parent2 Total.gv      Var_A       sdA      Var_D</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; 1  29988_30069   29988   30069  7.60248 0.02206726 0.1485505 0.05781974</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; 2  30069_30098   30069   30098  7.36695 0.02198121 0.1482606 0.06356747</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; 3  30069_30010   30069   30010  7.47667 0.01511091 0.1229264 0.03998785</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; 4  30069_29766   30069   29766  7.20845 0.02948413 0.1717094 0.04573390</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; 5  30069_29577   30069   29577  7.21645 0.01426810 0.1194492 0.03196729</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; 6  30069_29779   30069   29779  6.92268 0.02231110 0.1493690 0.04930136</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt; 7  30069_30042   30069   30042  6.50328 0.01838281 0.1355832 0.06310293</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt; 8  30069_29732   30069   29732  6.60909 0.01238753 0.1112993 0.03091797</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; 9  30069_29765   30069   29765  6.53291 0.02205777 0.1485186 0.03718066</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; 10 30069_29593   30069   29593  6.55606 0.01377457 0.1173651 0.03838363</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt;          sdD Usefulness</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="co">#&gt; 1  0.2404574    8.18549</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co">#&gt; 2  0.2521259    7.97027</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co">#&gt; 3  0.1999696    7.96085</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co">#&gt; 4  0.2138548    7.77417</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co">#&gt; 5  0.1787940    7.65998</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="co">#&gt; 6  0.2220391    7.47467</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a><span class="co">#&gt; 7  0.2512030    7.09210</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co">#&gt; 8  0.1758351    7.03834</span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="co">#&gt; 9  0.1928229    7.03495</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="co">#&gt; 10 0.1959174    7.02715</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a><span class="co"># 3.  Usefulness of trait number 1 - Non phased</span></span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a>usefNonPhased <span class="ot">&lt;-</span> <span class="fu">getUsefAD</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a>                           <span class="at">Markers =</span> generic_Geno, <span class="co"># non Phased haplotypes</span></span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a>                           <span class="at">addEff =</span> generic_MrkEffects[, <span class="dv">1</span>],</span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a>                           <span class="at">domEff =</span> generic_MrkEffects[, <span class="dv">3</span>],</span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a>                           <span class="at">Map.In =</span> generic_GenMap,</span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a>                           <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a>                           <span class="at">Method =</span> <span class="st">&quot;NonPhased&quot;</span>)</span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a><span class="fu">head</span>(usefNonPhased, <span class="dv">10</span>)</span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a><span class="co">#&gt;       Cross.ID Parent1 Parent2 Total.gv      Var_A       sdA    Var_D      sdD</span></span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a><span class="co">#&gt; 1  29988_30069   29988   30069  7.60248 0.09841212 0.3137071 3.849888 1.962113</span></span>
<span id="cb12-56"><a href="#cb12-56" tabindex="-1"></a><span class="co">#&gt; 2  30069_30098   30069   30098  7.36695 0.10418577 0.3227782 3.255957 1.804427</span></span>
<span id="cb12-57"><a href="#cb12-57" tabindex="-1"></a><span class="co">#&gt; 3  30069_29766   30069   29766  7.20845 0.10372587 0.3220650 2.972838 1.724192</span></span>
<span id="cb12-58"><a href="#cb12-58" tabindex="-1"></a><span class="co">#&gt; 4  30069_29577   30069   29577  7.21645 0.06916419 0.2629909 2.683442 1.638121</span></span>
<span id="cb12-59"><a href="#cb12-59" tabindex="-1"></a><span class="co">#&gt; 5  30069_30010   30069   30010  7.47667 0.10894299 0.3300651 2.219524 1.489807</span></span>
<span id="cb12-60"><a href="#cb12-60" tabindex="-1"></a><span class="co">#&gt; 6  30069_29760   30069   29760  6.48958 0.06908177 0.2628341 3.109599 1.763406</span></span>
<span id="cb12-61"><a href="#cb12-61" tabindex="-1"></a><span class="co">#&gt; 7  30069_29779   30069   29779  6.92268 0.08722246 0.2953345 2.276488 1.508803</span></span>
<span id="cb12-62"><a href="#cb12-62" tabindex="-1"></a><span class="co">#&gt; 8  30069_29765   30069   29765  6.53291 0.10405690 0.3225785 2.858590 1.690737</span></span>
<span id="cb12-63"><a href="#cb12-63" tabindex="-1"></a><span class="co">#&gt; 9  30069_29406   30069   29406  6.28254 0.08670396 0.2944554 2.879325 1.696858</span></span>
<span id="cb12-64"><a href="#cb12-64" tabindex="-1"></a><span class="co">#&gt; 10 30069_29593   30069   29593  6.55606 0.09917756 0.3149247 2.342416 1.530495</span></span>
<span id="cb12-65"><a href="#cb12-65" tabindex="-1"></a><span class="co">#&gt;    Usefulness</span></span>
<span id="cb12-66"><a href="#cb12-66" tabindex="-1"></a><span class="co">#&gt; 1    11.70116</span></span>
<span id="cb12-67"><a href="#cb12-67" tabindex="-1"></a><span class="co">#&gt; 2    11.14805</span></span>
<span id="cb12-68"><a href="#cb12-68" tabindex="-1"></a><span class="co">#&gt; 3    10.82648</span></span>
<span id="cb12-69"><a href="#cb12-69" tabindex="-1"></a><span class="co">#&gt; 4    10.63869</span></span>
<span id="cb12-70"><a href="#cb12-70" tabindex="-1"></a><span class="co">#&gt; 5    10.62423</span></span>
<span id="cb12-71"><a href="#cb12-71" tabindex="-1"></a><span class="co">#&gt; 6    10.16716</span></span>
<span id="cb12-72"><a href="#cb12-72" tabindex="-1"></a><span class="co">#&gt; 7    10.09397</span></span>
<span id="cb12-73"><a href="#cb12-73" tabindex="-1"></a><span class="co">#&gt; 8    10.08332</span></span>
<span id="cb12-74"><a href="#cb12-74" tabindex="-1"></a><span class="co">#&gt; 9     9.83498</span></span>
<span id="cb12-75"><a href="#cb12-75" tabindex="-1"></a><span class="co">#&gt; 10    9.77917</span></span></code></pre></div>
<p>The second part is using criterion for each cross (usefulness in this
example) together with a relationship matrix (based on markers in this
example) and create a optimum cross selection-based mating plan. The
idea is to restrict the levels of inbreeding, by means of the covariance
in the individual-cross level, and maximize the criterion used
(usefulness in this example). There is needed to set the target number
of crosses in the mating plan (<em>n.cross</em>), with the maximum and
minimum number of crosses that each parent can be part of
(<em>max.cross</em> and <em>min.cross</em>), together with the level of
covariance between cross via relationship matrix for the restriction
(<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned. Same step-by-step approach can be implemented for several
traits (using the function <code>getUsefAD_mt()</code>)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># 1. Relationship matrix</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (generic_Geno <span class="sc">%*%</span> <span class="fu">t</span>(generic_Geno)) <span class="sc">/</span> <span class="fu">ncol</span>(generic_Geno)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># 1. Main table to be optimized</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>MatingCrosses <span class="ot">&lt;-</span> <span class="fu">usef2Crosses</span>(<span class="at">Usefulness =</span> usefNonPhased, <span class="at">K =</span> relMat) <span class="co"># Using the non phasing output</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co"># 2. Crosses selected</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> MatingCrosses[[<span class="dv">1</span>]],</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>                             <span class="at">K =</span> relMat,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">25</span>,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">5</span>,</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="dv">1</span>)</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y target.K</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; 1                  1 8.073304 1.027206</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2        Y         K</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt; 1    29988   30069 11.70116 0.9819444</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt; 2    30069   30098 11.14805 0.9645833</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#&gt; 3    30069   29766 10.82648 0.9979167</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt; 4    30069   30010 10.62423 0.9750000</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt; 5    30069   29779 10.09397 0.9923611</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt; 6    30069   29765 10.08332 0.9569444</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">#&gt; 7    29406   29577  7.97671 0.9951389</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="co">#&gt; 8    30098   29577  7.66368 0.9833333</span></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="co">#&gt; 9    29406   30098  7.62707 0.9951389</span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="co">#&gt; 10   29426   29577  7.45193 0.9611111</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="co">#&gt; 11   29779   29193  7.37851 0.9777778</span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="co">#&gt; 12   30098   29141  7.34969 0.9888889</span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a><span class="co">#&gt; 13   29779   29141  7.29563 0.9736111</span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a><span class="co">#&gt; 14   29141   29574  7.24482 0.9694444</span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a><span class="co">#&gt; 15   29766   29805  7.20243 0.9916667</span></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a><span class="co">#&gt; 16   29988   29193  7.14927 0.9986111</span></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a><span class="co">#&gt; 17   29766   29193  7.09053 0.9944444</span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a><span class="co">#&gt; 18   29766   30010  7.06947 0.9680556</span></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a><span class="co">#&gt; 19   29988   29337  7.05978 0.9812500</span></span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a><span class="co">#&gt; 20   29988   29798  7.05157 0.9916667</span></span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a><span class="co">#&gt; 21   29988   29574  7.04159 0.9881944</span></span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a><span class="co">#&gt; 22   30098   29468  6.96265 0.9743056</span></span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a><span class="co">#&gt; 23   30098   29796  6.93581 0.9729167</span></span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a><span class="co">#&gt; 24   29975   30010  6.90805 0.9937500</span></span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a><span class="co">#&gt; 25   29779   29975  6.89621 0.9986111</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="pt4"></div>


</div>
<div id="optimization-using-total-genetic-value" class="section level2">
<h2>Optimization: Using total genetic value</h2>
<p>Here, we will create a mating plan through an optimization based on
total genetic value for one trait controlled by additive and dominance
effects, using molecular markers.</p>
<p>We need the cross plan, with all individuals candidates to parents.
We may use the function <code>planCross()</code> for doing so. The
parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getTGV()</code> to predict the total
genetic value for each cross in the cross plan, using the markers,
markers’ effects, and the relationship matrix for generating the input
for the new optimization function itself.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Loading the data</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">data</span>(generic_GenMap)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">data</span>(generic_Geno)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="fu">data</span>(generic_MrkEffects)</span></code></pre></div>
<p>Implementation</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># 1. Creating relationship matrix based on markers</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (generic_Geno <span class="sc">%*%</span> <span class="fu">t</span>(generic_Geno)) <span class="sc">/</span> <span class="fu">ncol</span>(generic_Geno)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># 2. Assigning parents</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(generic_Geno)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co"># 3. Creating the mating plan</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co"># 4. Estimates the total genetic value for the progenies of each cross</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>total_gv <span class="ot">&lt;-</span> <span class="fu">getTGV</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>                    <span class="at">Markers =</span> generic_Geno,</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>                    <span class="at">addEff =</span> generic_MrkEffects[, <span class="dv">1</span>],</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>                    <span class="at">domEff =</span> generic_MrkEffects[, <span class="dv">3</span>],</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>                    <span class="at">K =</span> relMat)</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt; TGVs predicted for 4950 crosses.</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="fu">head</span>(total_gv, <span class="dv">10</span>)</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt; 1    29121   29138 0.94021 1.1222222</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="co">#&gt; 2    29121   29141 3.82345 0.9694444</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a><span class="co">#&gt; 3    29121   29173 3.27528 0.9618056</span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a><span class="co">#&gt; 4    29121   29174 2.46291 0.9472222</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a><span class="co">#&gt; 5    29121   29179 3.63474 0.9548611</span></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a><span class="co">#&gt; 6    29121   29193 3.33305 1.0020833</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a><span class="co">#&gt; 7    29121   29205 1.54588 1.0201389</span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a><span class="co">#&gt; 8    29121   29213 2.04343 1.0395833</span></span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a><span class="co">#&gt; 9    29121   29233 2.06714 1.0194444</span></span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a><span class="co">#&gt; 10   29121   29245 2.34731 0.9881944</span></span></code></pre></div>
<p>The second part is using criterion for each cross (total genetic
value in this example) together with a relationship matrix (based on
markers in this example) and create a optimum cross selection-based
mating plan. The idea is to restrict the levels of inbreeding, by means
of the covariance in the individual-cross level, and maximize the
criterion used (total genetic value in this example). There is needed to
set the target number of crosses in the mating plan (<em>n.cross</em>),
with the maximum and minimum number of crosses that each parent can be
part of (<em>max.cross</em> and <em>min.cross</em>), together with the
level of covariance between cross via relationship matrix for the
restriction (<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co"># 1. Crosses selected</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> total_gv,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                             <span class="at">K =</span> relMat,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">25</span>,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">10</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="fl">1.1</span>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y target.K</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; 1                1.1 5.992452 1.043392</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; 1    29988   30069 7.60248 0.9819444</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; 2    30069   30010 7.47667 0.9750000</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; 3    30069   30098 7.36695 0.9645833</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; 4    30069   29577 7.21645 1.0034722</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; 5    30069   29766 7.20845 0.9979167</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; 6    30069   29779 6.92268 0.9923611</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; 7    30069   29732 6.60909 0.9736111</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt; 8    30069   29593 6.55606 1.0222222</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="co">#&gt; 9    30069   29765 6.53291 0.9569444</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co">#&gt; 10   30069   29776 6.50338 1.0041667</span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co">#&gt; 11   30069   30042 6.50328 1.0208333</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="co">#&gt; 12   29988   29593 5.79058 1.0680556</span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a><span class="co">#&gt; 13   29577   29141 5.45943 1.0013889</span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="co">#&gt; 14   29766   29577 5.45905 1.0722222</span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="co">#&gt; 15   29406   29577 5.39024 0.9951389</span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a><span class="co">#&gt; 16   29988   29577 5.31732 1.0236111</span></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="co">#&gt; 17   29779   29193 5.26292 0.9777778</span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a><span class="co">#&gt; 18   30098   29577 5.24666 0.9833333</span></span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a><span class="co">#&gt; 19   29988   30098 5.16477 1.0756944</span></span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a><span class="co">#&gt; 20   29426   29577 5.15370 0.9611111</span></span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a><span class="co">#&gt; 21   29988   29805 5.09140 1.0027778</span></span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a><span class="co">#&gt; 22   29577   30010 5.04938 0.9708333</span></span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a><span class="co">#&gt; 23   29577   29975 4.99133 1.0256944</span></span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a><span class="co">#&gt; 24   29141   29574 4.97513 0.9694444</span></span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a><span class="co">#&gt; 25   29779   29141 4.96099 0.9736111</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAGACAMAAABC/kH9AAAA7VBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrYAr7s6AAA6ADo6AGY6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmZgBmZjpmZmZmZpBmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQZmaQkDqQkGaQkLaQtraQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2kDq2kGa2kJC2tpC2tra2ttu225C229u22/+2/9u2///bkDrbkGbbtmbbtpDbtrbb25Db27bb29vb2//b///r6+vy8vL8Tgf/tmb/25D/27b/29v//7b//9v///+clGn7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAY/0lEQVR4nO2deV/cOJrHXRzZonYCCUPCNtn0AMlOd89OV5o0O2FTgZkk0BQkVe//5Yx12bIOS9ZlW/X8/uBD6bAfPV/rsGTLxRqUtYq+DQDFFQDOXAA4cwHgzAWAMxcAzlzegIu70Wp7e7tvE+IJAANgADxmAWAADIDHLAAMgAHwmAWAATAAHrMAcOYCwJkLAGcuAJy5AHDmAsCZCwBnLgCcuQBw5gLAmQsAZy4AnLlGCPi+VNADwmLDgADfVwp3TAA8GMD3vIIdFQAPA/C9qFAHBsD9A5bghiQMgHsGrKYLgK00AsBavgDYQsMHrOcbCjQA7hOwBV9fxgB4BIB9CAPgMQD2IAyAewRszdeDMADOHHDWAsCZKyPAQFiloQOGKuwpAJy5AHDmGjzgFDfCOSsvwMBZ0sABd2igoS4rNWzAbnyBMKdBA3blC4RrDQbwXikhxJ0vEK7UI2AO6V4lPjoVYFhsiAC4gXRvTya8B4CDqCfADaR7ezJhT76dCAPg4ID32sRSAOAQ6gVwK1/CGAAH0jABY7XhM/PfM5vBBID7AdyG0HQB3Iv3XG0CwIEBW/I1ATZUcXt7APDgANu04fb2AOCeAGsJWtVwxYlRjCIYAPcFWIPQXMVxrHDWOla0BwAHBuxEmP2yqeI0tnFOPl4wBwD3B1hFVXMByDWcP2XzCgjsxCFLD/jbxf6sqLX1sSfAHS4A4VrgzijW8dBuHK60gK95uoEBi7PPQYErCQNgEfCDwDcsYGH9yINhawNeEwbAIuB5ERVwY7nQi26z29UQlsdhwR05VGkAr84R1P1nJ5Ve3QYFfFcv+AfgayIMgEXA318UxRMDUl/AVAHo1oQl1uQcMuCNIawHPPm1C99UgBWoKsKq+kzOoUofyoMDlwZw2USbOt0eAOvp3jduhK0Ih/LgwKUBvF6kqsG2YE18pfoMgLF0gMs2ejoMwF2wKgiTs6hSBPPhoKUDvF4Wxe6HAQB25CsAVh0mmA8HLQ3g1duTpy33wQsWWtfySIBd+YoLDooDVSZs4mIDuk1qATwPB7idsDNfRrg6iyIFiwPAIuDvL+QR2NABt1RhACwCfpjJkyADBbzX0gszCzYRcNkHC+KnKpeKEXYUwB58O9wKbyLgdi2Ks3CA2wiHAUxnvAGwteZb//tmVhQH/G3UkAHrDkYN2GTAqy9f5MC6gz4aMGCJMAAW9e0dXvWfHH5thj/Misnr2zKaJxwFcNwqzAzYVMCfqoc6Jj82IpYF7YPn3Nh6hIDZPdSGAn7H3yQdSdFIZVtdRQzuNskCMCW8mYAXRUPysHmNFxWr+6VIy4UB+YoH29towGQg9eyny8v3P+gfyZpHB9z2bHtnwNKScWVAMH8OTjrAqAIf0rmN1TtdI50AsBqjgpcNYOmhD+X2L62muhazL2kAo4fupjxI5RNaZSr/PthiyV9bPRsBFnxZHmWEtZnOJe1DGsDCM1nljRHXRs8Z7TK46ptjAm6rnUrcbc9Kt8vKSuei9iA94ObyEf9zSeGXFbiu11EBW9ZOf748vwZKZYoxyAVwCXZyul4/vuQH1x473dm53Y6eN11KkPtXZWIg7yeQBjDqg7k7o2WzD0Zo8QTIaR3ms5WhrdsD0esolYWBvJ9AGsBoWFV3wuhFpcYC4eriaRn//IoL8tqrkvNcSnSWussR8LKehCZT0sqZjlCA76oeLz0+CymsCuH7JNIBJi8nFcUOffbO+B5LmO2E08OzUY6AhfdHzU/BA+BhSgu4QXhiaqDzBqxQkNKmkB7wevWG8W2MpmIC7gfW9va2IcWIq3AL4BLxzduTk1c/W71GCoCHqVbAXQSAG6UI4Y0gGhTgCPBsZASsNM1YhgAOCSAAHBawOUViSYDJtLPh3aQ4gENC66KAgC2SJNaAAIcj1lEmwGrjbIrg7RN/AWA7wHbsrBKlFQB2bKKtiuDtE39JgFdv0Xtm7S+fRQEcjFdnWQBWhdkUwdcp/pIAu2rDAFsWwdcp/gLAThMdtkXwdYq/dIAXzXcHIwJWOnDw0hbFIllSaQCj5eBuO6G5AU5PJpDsiuMBJpQ0gNEoOgHgPtCE0Z1yylmRqm/1Cjg9Fze1GtpWoECQfKQBjDdKMq/y+wGORySw2k3VFykUJB/pAKMqjN7yBsB7xj3LdWUKxchLGsCrf/5OntjZ2ac6CD+TFRVKQBktVRcqFCI/aQCnmKqMCiWgzKYqChYETggBYKPMploXt7OP/AWAQ6hDWV0g+UgH+HhfUPg+uD8ewdWlqE6Y3KUB3F0ZD7LM6lRQJ07OAsA2iw0mdSunGylHAeAAgDuW0wmUq9oAP/71KRlcff/JPOMx4qnKMICrf4zFdKflID1g+uYKAry0+EjWiBcbAgDm/zcX0hdaF2kBsxslBHhRmD/BMuLlQl/AhlGyKkM66QCz94Mx4LnF+6MbUYOVBptGyaoc6aQDjN7wLw5+mFWPWJqq8Mb2wcY+VpUlnXSAy0q7dcV210HV2dQLb+YoWlkOUzm9oXWRBjDdZYdtn9TcCA0AU2nKYSqnJ7Ju0gCmZBlgYdssAEykK4ahnN7QusgOcJQa7ObUCPKfyRLUXtIg3KylASw00YsYfXBYp3ooOuAhLjbM8T52BDDeTjj4KDqsT4ellsIGodZBOsD4NmmC9rN7RnbKCr0RWn/eTyFNgUMQ6ygd4Pr7k0TBZ7L6RhBXUVg5SQu4msrC2jU+Iw2AeUVh5SQt4PXqot4J7TD4alLfBGIrDi0H6QGXiN8fl/3vzoHV49EAuKE4tBzUBriTAHBDg3l4VgOYvOdf6eFkX/1pLABsUhxs9tIAFuYmH2bBJzr6dnwyRcFmLzvAEeai+/Z7QkUBZysZ8LcvpT6XRD98Yfr8LvyD7317Pa2isLOSDFj4aGG0Nxv69nlaxWBnJRlwc4ajUvDFhr5dXiv4YoNKMeDZSAYsbObPFPyjHPF9aqskgPsirACsaqSFT0SHADwcwmEB68oVAZ6NVIBXl5e/z4rJz5dUH758VRD1BjwYwhsHeG11X+QPeCiE0zTRLa89eBE0SANYmMmKBHgghAMD7lCFWyPDSAO4u6AGM5kA1/+rYkOrT8AhveqjlE00/1MRHV4S4HT7RadwqpUS3iYZEwQXAE4J2JggvABwQsDGBBHUH+AEPrVUsqlKiyTBJQFOtqV/fJ8OSTZFDg4XSQLsKgDcJqsSB4eLBIDjy7bEYclS6QAn2NI/hW/7l32Bw0HlpQGcYkv/JP7tXfYFDgeVlwZwih3fk/i3b3UocSikTfUIeCMI2xc4EFBRGsBJtvTfBMJ3usUFRcIo0gFOsaX/BhAWFgRbEsaSBrBpS//H4zLu4MoX8F3mjMUFQU2KkEBFaQAbpiqX9EktrhH3+bRdGm/HUZvx8oKglCK6nACjN1mu1o/n/P53Xt8uDOz0VGo1XhEzGsBz8pR0ebNcv/jv+XHK4M7voND7ZGmnroYEuG1L/5L+GW2pa+wbCFhnvrZQUpCfz6ykAdyqimtF2huwk4NDyRGwrgQthRICvVxmKRfAC/YeS9lGV68NbzrgO/kJWHWWlgPEkAvgOQe46oQBsEWhuAgvd3WQG+Cp9N8GAu70MR3bPMGlBry6+BO7AXqYSeuGEQCPfZBlXyg/N3WXEvD1rJ6IRnMau/yUFQBmciuUn586SwUYv114VDEsxA39ATCRY6H8HNVVCsBkHrIeR0mEIwyypBtEJ487KtYgaxBVWAZMkT6nDC+e8rxpDQ9+m3Qn3SC6uNxR8QAPoBeWAeMKzPe6N3hdiVtXiDDRgdR0gRsrJ0UE3D9hGfBcesod7+nAbTcbY6qSqC6+D7A06lImt5xBJAHGLbTwLMdCaKMjLDaISg+sozxKEtZTBkmA8aMcwlewUBWOulwoKz2xbtLZbFOSsJ4ySAlYfNxOCrsOu+CvUGpgDtIZbCpKWEeZ5AY44CM7OqVE5Sy1uYaSBHaUQRJgVR+MmugIXz5rVTpKPlJb216SwI4ySAKMR9HCFxoUQQCYSG1sW1EC+8kkGTC+Dz7l2V0XcqWODnhUhFWBVWSvn01SACaPY9VfacBfTTK/5hAc8EgIK00Vh1zCz5SSAbOdDHdfoV3u3r4kv0wbvkcA3DNhy9MbDeUKE95FZikAi59MEqeikwG+o27xJOUm6+vrrp+XymylAixvKGzmGwkwljcsF1mf15wwnmcspAK8Xv3W5Gvx2aQxA1YuNlif2JwunmcspAS8Xn97V28a/fxKhJkYcGzCWsBWJzani+gZszSAEePL9ycn/335xYZufoAb5259/8jCwObB0koPuKNyBWwywMZA8SDsV0SXVRoFYFfClvnMgI0v9hrs0CeJ6TWscQB2ImydUwHY+vxWBrYliOq2u9EAdiBsn18GbH16qxO0R0d123gA36nf0lT5qxMhJAkwy2DMb3cOw/mjOQxrRICRJMfY+qrFwQLgZmrNmXUnA8C+kvxi6ypLwPpjWp1GDbDl3ABYluAUW09ZAVak1J+500n6IjxCwLLsvGQL2MP/TnwBcChZ+hoAjxWw2f/KVCFPAICjyolvFwBR+bpdCwBY9LQHAp8ZN+sDdyzzRgHWwWv4zZmBLnMIwE7GYG0WYOVsmClJZMDdD2ttDdKGAb6z8JQP4O6EXQ5qb87mAb4zD1ZcMci5tYfqeGAAHFR+gJvw9MfpclQAHFYdAcvxdYgPmhZ7OmQGwAp18KghCQAephz4WhEOYw0A7qjt7W0hxNahFqn8+QJgXzkDtkrmzRcGWb6SAVu2rF0quo+BANhPCsB2LauP47sIAPtJBdimZRX9nopwp6wAWAP4zmXKK4p54qm65QTAesAmJQQMy4U+GgPgO1jwd5cr4GSDLB8BYAAMgHUCwOOQM+AgM82RBYC9NHi+ANhTQ+cLgP01YLp3ADh7AeDMBYAzFwDOXAA4cwHgzAWAMxcAzlwAOHMBYJ/FhhEIAANgADxmAWAADIDHLAAMgAHwmAWAATAAHrMAMAAGwGMWAAbAloBBg1QwwKBhCwBnLgCcuQBw5gLAmQsAZy4AnLlGBXh1vvVRDHs8Lm/6Dqy+Rh/RjG8XT5OboXQH0sNs8mv1Y1SAF4VUoiW5rZ+c9WrGckanF44SmqFyB9LqvBgp4EUhlehhVjy5Wj82ipTejNKK3Q9rZEaR8EJTuIOFjxLw6l0hl2hePLld44t22qMZrCqVZmBz+rIDq7zaRgn45mVR7Isl+v6CVpml+mJOY0Z9eS2TtSRKd1BjTsYIuEQ5OZUwVgEV6V7MqNQY3vRjx6KYLscJ+PBWrqcL1iSW122S8Y3ajErJarDWjofZ1sdRAl5/XSsa4jkHOE0nrDSDsydRT6Gzo/TD2XqcgJEUgKfSfz2YwVSOb9JZobRjgQwAwKHNoCqrT6oKrLEDNdAAOLwZRKu0t8EKO3ADDYDDm4GF+CadyFKNOackPCPAqQdZSjOoBYn5SnaQBjorwMlvk9RmlPr+sihOk1mgtmPBP3THrvdxA04+0aE2Y71+fJF2vUNpR4aA009Vqk+GJpbSrXbo7WDh2TTRPSw2qMxYJV3N0ttRhecDuI/lQtVQIO39kc6OKnz8gJfMpdc9LPiLZpQNdK2EI2mFO+ivjAD38ciOaMbDDACD+hIAzlwAOHMB4MwFgDMXAM5cADhzAeDMBYAzFwDOXCMD3Fjy3Dl4/VWbcl4m0L9Hsrr4m/lkc83LIaPSmAG3Tv22An58abP8A4DTSwKsJdwCePVbYbW+B4DTSwasWwhuAYzfKQbAg9SC8/nq06ylCgNgohEDpvVZ86wOACYaNWC80s4ofj4uf+08Z0v/HODPb9AGGsX+qyt2CL77FvKVukHPEJQBFeA5Toz34Zgc1gN3KecNCigmB69v9SGplQvg1RuG7ZD4sgKMnkjnkTYBS/nq9EdNwNf0uQ32dJCUkzsRTSOHpNeoAddNNE+RtNkV4Dk/JDsTAMv5+BAe8E4zSM7ZyIiHfnJIDxox4C+/MWYEweSX9RpXsyMWggAvWR27rlBwfbCcD/PfvSJ7YHCAcaNd3j/zx2/kXNKA1Sd2IjmkB40QcFO4luK2+owlqKDguG/vj+umGv9XA5bz4SckySW0aAKeVhmmypxzhn692Hn1f6ztaIb0oLED3q1YkL4YA0KOl0fRVZdaA5bzcbW7Zj2vmtjqKpFzokRT6YTT3kZXVOMGPCGjU+x2rgtF1UYAvMJDYwGwIt+i7i5xUAWY63nLw2pylgZxs+NySA8aM+BddoMiDIyw5znAq/fHLEYBuJmPv/dtjKIVgJs5q6ejD36h15Uc0oNGCBi5+jMe7ezSkWnj1QIRcH07IwFW5OMrfqM/bwJWnZG7+Oi9sRySXiMFTKsQbUxFdyNCjBSNm7z6IPfBinx8DZYHbFrAOPbmZfWb3vbKIck1VsC0/SP/Y3cLtyEMCq5Fh2xQqwA81ZxAaKIVgOUbn8e/slaZHUMOSazRAqb7zNZzDGrAXJQMWJFPO8hqAladkWh182bGjq8LSanxAqbTD2di8LqOZVUN34zWvJYt+er7W/KvBrDqjM1jHLWHJNOIAZN+EP+qHbj8z2c/4/sSHnA9vSEAlvPVlwG5gHSA5Zzfbt4+JQzZRSKH9KARA+YbaQzjz7frmxlrYhkUFnM9Ey+H1VdVPnxQxVSlAFjKSS63MoDMZ5b55JA+NGbAxMkYi/wOdmMuulIj8VT57nZjcUIPWMrZPNGZMqQHjRowcTL292N1QzL5EcdVUNjN6OQvbBaTBT25VeRjVbeMvm4DLOdk64ko5FQTkl6jBkzrCKl5ZG19n80M1lA+o3msnde3XBCet9x/rcrHMhz8go+uByznXN38gJ4s4Jb35ZDkGhlgUFcB4MwFgDMXAM5cADhzAeDMBYAzFwDOXAA4cwHgzAWAMxcAzlwAOHMB4MwFgDMXAM5cADhzAeDMBYAzFwDOXAA4cwHgzAWAMxcAzlwAOHMB4MwFgDMXAM5cPQL+Qy0wJ6gA8EDNCaUhAL4v1b9Hawv2SvVuTij1Dvi+0jAA71UCwJ4S+DLCvZrD8aWE+zInlHoGfH8vEWbRi51XbPu/x7dPxR0uHn9aoxf8rbcmWp2bNkGR+BLCVfyCvdlvddZHtDfWRNrAsNUMXCZZDzOfrab7BXx/LxNm0Yt6M9FzaQsTUujggPf2JMJV/IIZYXPWapdKIWmbGTqQGQOmW86hbY+UgDsoCGByCAvApcVo+6TVxUzYyR8A84Cfzeh+6Vv/NQjA++yLAEbAVZKFkHbDAIt8MWEWvSj+fE734p/OMeBH/HmcgyvaAh4RP84nf39TFLu/oDyPL4vJj7VDSnf+/zuSg3i2PkIjGzVH4osIr2t7Ts/pVmkY2nV5qB28OZJ0KOkaQLvO4rQUcPUb7do0I/swLViLzkU+HhfF4b+yBXy0wA59mJ1hwGx/7TKwAbgKpSme8YD/h8Zhz3JH4LMxc0yAz5Z0azXucy3VZnqN76o8zCan3MZJtEc+ZIDr3+w4RzVgLlIsj4sGDfgBt9GLrY9z8lEEvC3gC+QFbpA1R182Kf00RX8Ob9HXVWrARXG6Xs1xXOlZ/gh1tsocI+Ay0xE96wJ/T+VmpjxUmQaNoZ/9zIbdux/oF0+xGdzv8ji7V+h6+LUuE5cYl2fm9cGWQQNeneOde6frOdcHLyTAZCPBaRlIt7bjAKO47y+2PvKd36KZrTLHDBgdCZ91RVprckrpUOjUF/hra7ukN8Bpv79g1xn/G//PlYmLlMrjoiEPso5wacsWmgFefb58e1yIgGk7PmU9H98HE2+VSSjg+gh1ttocwyDrjDgbneb7C7bzXQWMWFAU9Yj/cwkZ9w7snunJLUrP/2bHqezmI5fsUz75Al6WzlrgtvWM+/hCZ8AlG0yCP4Ib4NL/Z03A5WF0gNfkgqi3LSUNCf9bAsxHSuVx0bABlw0VaqHXtA+enPx0+VVqou1rMH8EN8Co2bzW12Aq3JLT/0itZTGkBvPbqUo1uI7MoAa3TlViDFv/mJ0RwNQXpF9VAjb1wY0jKAG3T1XSj+jtS32weKgyEd1clvbRVZ2m1xn3u85L++A6MoM+uG2xYUFGrPvks3EIMBq3ok18MeD/uJUAS6POMqAeYSPA3BHUgFsWGyhg1IaKo2gJcNlUo8/Qrsp4/DU1tJnw6jc2mOd+k1H04zm5DSRlqiPn6MNpNyMeRbcuF2LApTury7raqZt+hepIBFzd53JN9FPSnbGqUx9BA1i/XLiopqKl+2AJcD0XjW5n1+9Yr0pb4Po3Ow77SsBRI3L098F/1IyrH03Aq3P6IcIzMudT7Lz+F264Ps3oeLbhXlQ7d3/n++C/l/56fkvbRv4IOsB/6Bb8GWDa7jdmsiTAbM6Mzm5d409L31ZdbPWbzmSRfz+RuspFPpajwsNR98EKeR+3nidkPWWv5vSsnAA/zLau2AwRFgDOCzDrF6d1AADO6rlo0sfWn7/oBDhTZQUYJAsAZy4AnLkAcOYCwJkLAGcuAJy5AHDmAsCZCwBnLgCcuQBw5gLAmQsAZ65/A3MngMNczu2MAAAAAElFTkSuQmCC" /><!-- --></p>
<div id="pt5"></div>

</div>
<div id="optimization-using-the-mean-parental-average" class="section level2">
<h2>Optimization: Using the Mean Parental Average</h2>
<p>Here, we will create a mating plan through an optimization based on
the mean parental average for one additive trait using pedigree
information.</p>
<p>We need the cross plan, with all individuals candidates to parents.
We may use the function <code>planCross()</code> for doing so. The
parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). Then, we need to
organized the dataset for the predictions. Basically, the input to
calculate the mean parental average is a two column data frame, where in
the first row we have the individuals identification (same names that we
find in the cross plan), and the criterion. By criterion you can
specified the estimated breeding value (ebv) or even the best linear
unbiased prediction (BLUP) for each individuals. This allow us to use
this function for poliploids individuals, for example. In this case, we
can make the predictions and input the values to calculate the expected
mean parental average for each cross.</p>
<p>The upcoming step is to use the function <code>getMPA()</code> to
predict the mean parental average for each cross in the cross plan,
using the BLUP information from each individual. The relationship matrix
based on pedigree (in this case) is used to restrict for inbreeding. You
can use the relationship matrix based on markers as well, instead of the
pedigree-based matrix. We will use the package
<strong>AGHmatrix</strong> for that (Amadeu et al. 2022).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co"># 1. Loading the information</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">data</span>(generic_Pedigree)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">data</span>(generic_IndBLUP)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="fu">data</span>(generic_Geno)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co"># 2. Using AGHMatrix to build the G matrix</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>AMat <span class="ot">&lt;-</span> AGHmatrix<span class="sc">::</span><span class="fu">Amatrix</span>(<span class="at">data =</span> generic_Pedigree)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt; Verifying conflicting data... </span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; Organizing data... </span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; Your data was chronologically organized with success. </span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; Constructing matrix A using ploidy = 2 </span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt; Completed! Time = 0  minutes</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co"># 3. Assigning parents</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(generic_Geno)</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co"># 4. Creating the mating plan</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>CrossPlan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>                       <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a><span class="co"># 5. Criterion</span></span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a>Crit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Id =</span> generic_IndBLUP[,<span class="dv">1</span>],</span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a>                   <span class="at">Criterion =</span> generic_IndBLUP[, <span class="dv">2</span>])</span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a><span class="co"># 6.Single trait mean parental average</span></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a>ST_mpa <span class="ot">&lt;-</span> <span class="fu">getMPA</span>(<span class="at">MatePlan =</span> CrossPlan,</span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a>                 <span class="at">Criterion =</span> Crit,</span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a>                 <span class="at">K =</span> AMat)</span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a><span class="co">#&gt; 4950 possible crosses were predicted</span></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a><span class="fu">head</span>(ST_mpa, <span class="dv">20</span>)</span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2        Y K</span></span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a><span class="co">#&gt; 1    29988   30069 175.1673 0</span></span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a><span class="co">#&gt; 2    30069   29406 173.9280 0</span></span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a><span class="co">#&gt; 3    30069   29551 169.9036 0</span></span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a><span class="co">#&gt; 4    30069   30098 169.8895 0</span></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a><span class="co">#&gt; 5    30069   29768 169.8379 0</span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a><span class="co">#&gt; 6    30069   29766 169.4261 0</span></span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a><span class="co">#&gt; 7    30069   29426 169.2966 0</span></span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a><span class="co">#&gt; 8    29988   29406 169.0046 0</span></span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a><span class="co">#&gt; 9    30069   29497 168.9645 0</span></span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a><span class="co">#&gt; 10   30069   29898 168.8804 0</span></span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a><span class="co">#&gt; 11   30069   29577 168.2743 0</span></span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a><span class="co">#&gt; 12   30069   29760 168.2431 0</span></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a><span class="co">#&gt; 13   30069   29791 168.1582 0</span></span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a><span class="co">#&gt; 14   30069   29372 167.7388 0</span></span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a><span class="co">#&gt; 15   30069   29975 167.4502 0</span></span>
<span id="cb19-52"><a href="#cb19-52" tabindex="-1"></a><span class="co">#&gt; 16   30069   29529 167.2337 0</span></span>
<span id="cb19-53"><a href="#cb19-53" tabindex="-1"></a><span class="co">#&gt; 17   30069   29601 167.1417 0</span></span>
<span id="cb19-54"><a href="#cb19-54" tabindex="-1"></a><span class="co">#&gt; 18   30069   29141 167.0200 0</span></span>
<span id="cb19-55"><a href="#cb19-55" tabindex="-1"></a><span class="co">#&gt; 19   30069   29121 166.8110 0</span></span>
<span id="cb19-56"><a href="#cb19-56" tabindex="-1"></a><span class="co">#&gt; 20   30069   29792 166.7701 0</span></span></code></pre></div>
<p>The second part is using criterion for each cross (mean parental
average in this example) together with a relationship matrix (based on
pedigree information in this example) and create a optimum cross
selection-based mating plan. The idea is to restrict the levels of
inbreeding, by means of the covariance in the individual-cross level,
and maximize the criterion used (mean parental average in this example).
There is needed to set the target number of crosses in the mating plan
(<em>n.cross</em>), with the maximum and minimum number of crosses that
each parent can be part of (<em>max.cross</em> and <em>min.cross</em>),
together with the level of covariance between cross via relationship
matrix for the restriction (<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># 1. Crosses selected</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> ST_mpa,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                             <span class="at">K =</span> AMat,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">25</span>,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">10</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="fl">0.21</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y  target.K</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt; 1               0.21 166.9377 0.1006944</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2        Y K</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co">#&gt; 1    29988   30069 175.1673 0</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co">#&gt; 2    30069   29406 173.9280 0</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="co">#&gt; 3    30069   29551 169.9036 0</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co">#&gt; 4    30069   30098 169.8895 0</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co">#&gt; 5    30069   29768 169.8379 0</span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="co">#&gt; 6    30069   29766 169.4261 0</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="co">#&gt; 7    30069   29426 169.2966 0</span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co">#&gt; 8    29988   29406 169.0046 0</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="co">#&gt; 9    30069   29497 168.9645 0</span></span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a><span class="co">#&gt; 10   30069   29898 168.8804 0</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a><span class="co">#&gt; 11   30069   29577 168.2743 0</span></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co">#&gt; 12   30069   29760 168.2431 0</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="co">#&gt; 13   29988   29551 164.9802 0</span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a><span class="co">#&gt; 14   29988   30098 164.9661 0</span></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="co">#&gt; 15   29988   29768 164.9145 0</span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a><span class="co">#&gt; 16   29988   29766 164.5027 0</span></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co">#&gt; 17   29988   29426 164.3733 0</span></span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a><span class="co">#&gt; 18   29988   29497 164.0412 0</span></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a><span class="co">#&gt; 19   29988   29898 163.9571 0</span></span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a><span class="co">#&gt; 20   29406   29551 163.7409 0</span></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a><span class="co">#&gt; 21   29406   30098 163.7268 0</span></span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a><span class="co">#&gt; 22   29406   29768 163.6752 0</span></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a><span class="co">#&gt; 23   29988   29577 163.3510 0</span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a><span class="co">#&gt; 24   29406   29766 163.2634 0</span></span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a><span class="co">#&gt; 25   29406   29426 163.1340 0</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="pt6"></div>

</div>
<div id="optimization-using-the-linkage-disequilibrium-to-predicts-the-crosses-variance" class="section level2">
<h2>Optimization: Using the linkage disequilibrium to predicts the
crosses variance</h2>
<p>From the original proposition, a genetic map (the map that shows the
recombination rates in the population) is required (Lehermeier et
al. 2017) for the estimation of cross’ variance. In addition, it is not
straightforward to have a genetic map that represents the target
population under study. In this way, we replace the information of the
matrix with the recombination frequencies between pair of SNPs by the
linkage disequilibrium (LD) matrix. It is known that the the LD varies
from 0-1 in a population, being values close to an integer the
recombination is low and when it is close to zero, the recombination
frequency is high. Linkage disequilibrium can be estimated from a
markers matrix (with or without phasing information). It was implemented
in the function that estimates the usefulness (<code>getUsefA</code>,
<code>getUsefAD</code>, <code>getUsefA_mt</code>, and
<code>getUsefAD_mt</code>) the estimation of the cross variance and,
ultimately, the cross usefulness by using the LD matrix. By doing so,
the user may give the LD matrix in the argument <code>linkDes</code> and
give the chromosome and the SNP id in the argument
<code>Map.In</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># 1. Load data</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;lines_Geno&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># 2. Assuming a naive assumption of the LD measure</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>linkageDes <span class="ot">&lt;-</span> (<span class="fu">t</span>(lines_Geno) <span class="sc">%*%</span> lines_Geno)<span class="sc">/</span>(<span class="fu">ncol</span>(lines_Geno))</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co"># 3. Assigning the parents</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(lines_Geno)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co"># 4. Creating the cross plan</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co"># 5. Information on the SNPs</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>mapInfo <span class="ot">=</span> lines_GenMap[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co"># 6.  Usefulness of trait number 1 (DH)</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>usef_add <span class="ot">&lt;-</span> <span class="fu">getUsefA</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>                     <span class="at">Markers =</span> lines_Geno,</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>                     <span class="at">addEff =</span> lines_addEffects[, <span class="dv">1</span>],</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>                     <span class="at">Map.In =</span> mapInfo,</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>                     <span class="at">linkDes =</span> linkageDes,</span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>                     <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>                     <span class="at">Type =</span> <span class="st">&quot;DH&quot;</span>,</span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>                     <span class="at">Generation =</span> <span class="dv">1</span>)</span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a><span class="fu">head</span>(usef_add, <span class="dv">10</span>)</span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co">#&gt;    Cross.ID Parent1 Parent2    Mean  Variance        sd Usefulness</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="co">#&gt; 1     G1_G2      G1      G2 4.51880 0.1205174 0.3471562    5.23488</span></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a><span class="co">#&gt; 2     G2_G3      G2      G3 4.01124 0.3289240 0.5735190    5.19424</span></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a><span class="co">#&gt; 3     G1_G3      G1      G3 4.10644 0.2206587 0.4697432    5.07539</span></span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a><span class="co">#&gt; 4     G1_G4      G1      G4 4.27818 0.1269868 0.3563520    5.01323</span></span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a><span class="co">#&gt; 5     G2_G4      G2      G4 4.18298 0.1609132 0.4011399    5.01042</span></span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a><span class="co">#&gt; 6     G3_G4      G3      G4 3.77061 0.3408383 0.5838136    4.97485</span></span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a><span class="co">#&gt; 7     G1_G5      G1      G5 3.48462 0.3643654 0.6036268    4.72973</span></span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a><span class="co">#&gt; 8     G2_G5      G2      G5 3.38943 0.4088559 0.6394184    4.70837</span></span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a><span class="co">#&gt; 9     G1_G9      G1      G9 3.04164 0.6263750 0.7914386    4.67415</span></span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a><span class="co">#&gt; 10   G1_G24      G1     G24 3.09747 0.5749812 0.7582751    4.66157</span></span></code></pre></div>
<div id="pt7"></div>

</div>
<div id="thinning-by-relatedness-how-to-increase-prediction-speed" class="section level2">
<h2>Thinning by relatedness: How to increase prediction speed</h2>
<p>The <em>relateThinning()</em> is an optional step and it will
increase the efficiency of the prediction by cutting individuals by
relatedness and, consequently, decreases time for the prediction of
usefulness and cross optimization. It selects the top individuals within
a family by the relatedness <code>threshold</code>. For example, if
<code>max.per.cluster=10</code> and <code>threshold = 1</code> the
algorithm will identify all groups of individuals that shared more than
0.5 in the relationship matrix and select the top 2 individuals with
highest criterion to be used as possible parents in the mating plan.
Besides those arguments, we need to give to the function the
relationship matrix (<code>K</code>) between the parents. It could be
the relationship matrix based on markers information (G) or based on
pedigree information (A). In addition, a <code>criterion</code> should
be added, such as the estimated breeding value, total breeding value, or
the BLUP of the candidates.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># 1. Loading the data</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;generic_Geno&quot;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;generic_IndBLUP&quot;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co"># 2. Creating relationship matrix based on markers</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (generic_Geno <span class="sc">%*%</span> <span class="fu">t</span>(generic_Geno)) <span class="sc">/</span> <span class="fu">ncol</span>(generic_Geno)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co"># 3. Criterion for the trait</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>Crit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Id =</span> <span class="fu">rownames</span>(generic_IndBLUP),</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>                   <span class="at">Criterion =</span> generic_IndBLUP[, <span class="dv">2</span>]) <span class="co"># trait number one</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>                    </span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co"># 4. Trimming by relatedness</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="fu">relateThinning</span>(<span class="at">K =</span> relMat,</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>                      <span class="at">Criterion =</span> Crit,</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>                      <span class="at">threshold=</span><span class="dv">1</span>,</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>                      <span class="at">max.per.cluster=</span><span class="dv">10</span>)</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt; 12 genotypes kept out of 100</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co"># 5. Crossing plan using the argument Indiv2keep</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a>plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> <span class="fu">colnames</span>(relMat),</span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>                 <span class="at">MateDesign =</span> <span class="st">&#39;half&#39;</span>,</span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a>                 <span class="at">Indiv2keep =</span> keep)</span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 66</span></span></code></pre></div>
<p>As a result, we kept 85 individuals out of 100 individuals. In such
case, we will predict usefulness or mean parental average/total genetic
value for 3570 crosses instead of 4950 crosses (number of crosses
resulted from the matching of 100 individuals). When we have a large
number of parents, such as 2000 individuals as candidates to parents,
the function can be used to decrease the time for prediction and
optimization.</p>
</div>
<div id="bibliography" class="section level2">
<h2>Bibliography</h2>
<p>Akdemir &amp; Sánchez (2016). Efficient breeding by genomic mating.
Frontiers in Genetics. <a href="https://doi.org/10.3389/fgene.2016.00210" class="uri">https://doi.org/10.3389/fgene.2016.00210</a><br />
Allier et al. (2019). Usefulness criterion and post-selection parental
contributions in multi-parental crosses: Application to polygenic trait
introgression. G3: Genes, Genomes, Genetics. <a href="https://doi.org/10.1534/g3.119.400129" class="uri">https://doi.org/10.1534/g3.119.400129</a><br />
Bonk et al. (2016). Mendelian sampling covariability of marker effects
and genetic values. Genetics Selection Evolution. <a href="https://gsejournal.biomedcentral.com/articles/10.1186/s12711-016-0214-0" class="uri">https://gsejournal.biomedcentral.com/articles/10.1186/s12711-016-0214-0</a><br />
Lehermeier (2017). Genetic gain increases by applying the usefulness
criterion with improved variance prediction in selection of crosses.
Genetics. <a href="https://doi.org/10.1534/genetics.117.300403" class="uri">https://doi.org/10.1534/genetics.117.300403</a><br />
Schnell &amp; Utz (1976). F1 Leistung und Elternwahl in der Zuchtung von
Selbstbefruchtern. Ber Arbeitstag Arbeitsgem Saatzuchtleiter.<br />
Toro &amp; Varona (2010). A note on mate allocation for dominance
handling in genomic selection. Genetics Selection Evolution. <a href="https://doi.org/10.1186/1297-9686-42-33" class="uri">https://doi.org/10.1186/1297-9686-42-33</a><br />
Varona et al. (2018). Non-additive effects in genomic selection.
Frontiers in Genetics. <a href="https://doi.org/10.3389/fgene.2018.00078" class="uri">https://doi.org/10.3389/fgene.2018.00078</a><br />
Wolfe et al. (2021). Genomic mating in outbred species: Predicting cross
usefulness with additive and total genetic covariance matrices.
Genetics. <a href="https://doi.org/10.1093/genetics/iyab122" class="uri">https://doi.org/10.1093/genetics/iyab122</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
