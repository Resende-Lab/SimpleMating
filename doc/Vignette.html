<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Marco Antonio Peixoto" />

<meta name="date" content="2024-12-02" />

<title>SimpleMating: A R package to breeding crosses optimization</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">SimpleMating: A R package to breeding
crosses optimization</h1>
<h4 class="author">Marco Antonio Peixoto</h4>
<h4 class="date">2024-12-02</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><strong>SimpleMating</strong> is a two-module package for
cross-optimization. First, it estimates the performance for a set of
crosses, such as mean parental average, cross total genetic value,
and/or usefulness (using additive and/or non-additive effects), allowing
for multi-trait scenarios. Furthermore, it uses a mate allocation
algorithm to create a mating plan aiming to maximize a target criterion
(mean parental average, total genetic value, or usefulness) and
constrains the next generation’s inbreeding levels.</p>
<p>In this tutorial, we will explain the implementation of both modules
while connecting it with examples using the data from the package.</p>
</div>
<div id="input-files" class="section level2">
<h2>Input files</h2>
<p>Four files are needed but not all required, to run analyses in
<strong>SimpleMating</strong>:</p>
<ol style="list-style-type: lower-roman">
<li>Matrix with markers from the parental population;<br />
</li>
<li>Marker effects for the target trait (or traits);<br />
</li>
<li>Genetic map for recombination frequency estimation or linkage
disequilibrium matrix;<br />
</li>
<li>relationship matrix (pedigree- or marker-based).</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># 1. Install and require the package</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># install.packages(SimpleMating)</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; Loading required package: SimpleMating</span></span></code></pre></div>
<div id="marker-matrix" class="section level4">
<h4>1) Marker matrix</h4>
<p>The marker matrix has the information of genotypes (100 genotypes) in
the lines and the information of SNPs in the columns, coded as 0,1,2
meaning the number of copies of the alternate allele presented for each
loci.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Marker matrix</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">data</span>(lines_Geno)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>lines_Geno[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;    Chr1_SNP1 Chr1_SNP2 Chr1_SNP3 Chr1_SNP4 Chr1_SNP5</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; G1         0         0         2         0         2</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; G2         0         0         2         0         0</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; G3         0         0         2         0         2</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; G4         0         0         2         0         0</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; G5         0         0         2         0         0</span></span></code></pre></div>
</div>
<div id="marker-effects" class="section level4">
<h4>2) Marker effects</h4>
<p>This is a data frame with the information on the effects for each
marker from the matrix before mentioned for the trait under evaluation.
In this case, each row represents one marker and each column one trait
(two traits and 1230 markers).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Marker Effects</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">data</span>(lines_addEffects)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">head</span>(lines_addEffects)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;      add_trait1    add_trait2</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 1  0.0207632801  1.034444e-03</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 2 -0.0018488022 -7.234415e-03</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 3 -0.0073807532  2.244785e-03</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 4 -0.0066209813  2.713244e-03</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 5  0.0004828055 -3.478676e-05</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 6 -0.0204069302  1.191772e-02</span></span></code></pre></div>
</div>
<div id="genetic-map" class="section level4">
<h4>3) Genetic map</h4>
<p>The genetic map is a data frame with the markers’ position
information in the genome. There are three columns in the file, being
the first the chromosome, the second represents the actual position of
the marker (in centimorgan), and the third is the marker name.
<strong>SimpleMating</strong> also allows the use of a linkage
disequilibrium matrix for recombination instead of the genetic map. We
discuss this below and give more details in the main paper.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Genetic Map</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">data</span>(lines_GenMap)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">head</span>(lines_GenMap)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt;   chr         pos  mkr</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 1   1  0.07865088  1_2</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 2   1  3.64901989 1_11</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 3   1  6.60301305 1_20</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 4   1  7.04754570 1_22</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 5   1  9.34700329 1_27</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; 6   1 11.35608253 1_33</span></span></code></pre></div>
</div>
<div id="relationship-matrix" class="section level4">
<h4>4) Relationship matrix</h4>
<p>For the optimization itself, to restrict inbreeding levels, we need a
relationship matrix. It could be a numerator relationship matrix based
on pedigree data or a realized relationship matrix based on markers.
Make sure that your relationship matrix contains the names of the
individual’s genotypes as columns and row names.</p>
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>We going to cover seven examples of implementation, as follows:</p>
<ol style="list-style-type: decimal">
<li>Optimization based on usefulness for one additive trait using
molecular markers. <a href="#pt1">shortcut</a><br />
</li>
<li>Optimization based on usefulness for two additive traits using
molecular markers. <a href="#pt2">shortcut</a><br />
</li>
<li>Optimization based on usefulness for one additive/dominance trait
using molecular markers. <a href="#pt3">shortcut</a><br />
</li>
<li>Optimization based on total genetic value for one additive/dominance
trait using molecular markers. <a href="#pt4">shortcut</a><br />
</li>
<li>Optimization based on the mid-parental value for one additive trait
using pedigree information. <a href="#pt5">shortcut</a></li>
<li>Optimization: Using the linkage disequilibrium to predict the cross
variance. <a href="#pt6">shortcut</a></li>
<li>Thinning by relatedness: How to increase prediction speed. <a href="#pt7">shortcut</a></li>
</ol>
</div>
<div id="pt1">
<div id="optimization-usefulness-on-additive-trait" class="section level2">
<h2>Optimization: Usefulness on additive trait</h2>
<p>Here, we will create a mating plan based on the usefulness of one
additive trait.</p>
<p>First, we create a crossing plan. The user may inform their own or
use the function <code>planCross()</code> to create the crossing plan.
The parents are all individuals genotyped and the information of their
names should go in the argument <em>TargetPop</em>. We may choose which
mate design we want (<em>MateDesign</em>). The upcoming step is to use
the function <code>getUsefA()</code> to predict the usefulness of each
cross in the crossing plan, using the markers, markers’ effects, and the
genetic map. For this function, we may set the proportion of selection
individuals (<em>proSel</em>), the population type (<em>Type</em>), and
the generation (<em>Generation</em>).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># 1. Assigning the parents</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(lines_Geno)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># 2. Creating the crossing plan</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co"># 3. Creating a relationship matrix based on markers</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (lines_Geno <span class="sc">%*%</span> <span class="fu">t</span>(lines_Geno)) <span class="sc">/</span> <span class="fu">ncol</span>(lines_Geno)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co"># 4.  Usefulness of trait number 1 (DH)</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>usef_add <span class="ot">&lt;-</span> <span class="fu">getUsefA</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>                     <span class="at">Markers =</span> lines_Geno,</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>                     <span class="at">addEff =</span> lines_addEffects[, <span class="dv">1</span>],</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>                     <span class="at">Map.In =</span> lines_GenMap,</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>                     <span class="at">K =</span> relMat,</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>                     <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>                     <span class="at">Type =</span> <span class="st">&quot;DH&quot;</span>,</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>                     <span class="at">Generation =</span> <span class="dv">1</span>)</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="fu">head</span>(usef_add[[<span class="dv">1</span>]], <span class="dv">10</span>)</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt;    Cross.ID Parent1 Parent2    Mean  Variance        sd Usefulness</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt; 1     G1_G2      G1      G2 4.51880 0.1333033 0.3651072    5.27191</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="co">#&gt; 2     G2_G3      G2      G3 4.01124 0.3056290 0.5528372    5.15158</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co">#&gt; 3     G2_G4      G2      G4 4.18298 0.2135113 0.4620728    5.13610</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="co">#&gt; 4     G1_G3      G1      G3 4.10644 0.2235912 0.4728543    5.08180</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="co">#&gt; 5     G1_G4      G1      G4 4.27818 0.1284029 0.3583335    5.01732</span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="co">#&gt; 6     G3_G4      G3      G4 3.77061 0.3159532 0.5620971    4.93005</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="co">#&gt; 7     G2_G5      G2      G5 3.38943 0.3341835 0.5780861    4.58186</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="co">#&gt; 8     G1_G5      G1      G5 3.48462 0.2635954 0.5134154    4.54365</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="co">#&gt; 9    G1_G30      G1     G30 3.40499 0.2795036 0.5286810    4.49551</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="co">#&gt; 10   G1_G24      G1     G24 3.09747 0.4479298 0.6692756    4.47799</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a><span class="fu">head</span>(usef_add[[<span class="dv">2</span>]], <span class="dv">10</span>)</span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a><span class="co">#&gt; 1       G1      G2 5.27191 1.2292683</span></span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a><span class="co">#&gt; 2       G2      G3 5.15158 0.9886179</span></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a><span class="co">#&gt; 3       G2      G4 5.13610 1.2162602</span></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a><span class="co">#&gt; 4       G1      G3 5.08180 1.0569106</span></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a><span class="co">#&gt; 5       G1      G4 5.01732 1.2227642</span></span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a><span class="co">#&gt; 6       G3      G4 4.93005 0.9821138</span></span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a><span class="co">#&gt; 7       G2      G5 4.58186 1.0373984</span></span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a><span class="co">#&gt; 8       G1      G5 4.54365 1.0373984</span></span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a><span class="co">#&gt; 9       G1     G30 4.49551 1.0796748</span></span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a><span class="co">#&gt; 10      G1     G24 4.47799 1.0243902</span></span></code></pre></div>
<p>The second part uses a criterion for each cross (usefulness in this
example) with a relationship matrix (based on markers in this example)
and creates an optimum cross-selection-based mating plan. The idea is to
restrict the levels of inbreeding, using the covariance in the
individual-cross level, and maximize the criterion used (usefulness in
this example). There is needed to set the target number of crosses in
the mating plan (<em>n.cross</em>), with the maximum and minimum number
of crosses that each parent can be part of (<em>max.cross</em> and
<em>min.cross</em>), together with the level of covariance between cross
via relationship matrix for the restriction
(<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># 1. Creating the mating plan</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> usef_add[[<span class="dv">2</span>]],</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">10</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">2</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="dv">1</span>)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y  target.K</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; 1                  1 3.870613 0.9710569</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; 1       G2      G3 5.15158 0.9886179</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; 2       G3      G4 4.93005 0.9821138</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; 3       G1     G13 4.33268 0.9788618</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; 4       G2     G24 4.32874 0.9918699</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; 5       G4     G24 4.23663 0.9463415</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; 6       G1     G10 4.19402 0.9658537</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; 7      G30     G98 2.92482 0.9528455</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; 8       G5     G56 2.92043 0.9788618</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; 9      G14     G30 2.90544 0.9495935</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; 10      G5     G54 2.78174 0.9756098</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="pt2">
<div id="optimization-usefulness-on-multi-traits-scenario" class="section level2">
<h2>Optimization: Usefulness on Multi traits scenario</h2>
<p>Here, we will create a mating plan based on the usefulness of two
additive traits.</p>
<p>We need the crossing plan, with all individual candidates to be
parents. We may use the function <code>planCross()</code> for doing so.
The parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getUsefA_mt()</code> to predict the
usefulness of each cross in the cross plan, using the markers, markers’
effects, and the genetic map. In addition, we need to set weights for
each trait (<em>Weights</em>), in a way to build a trait-based index for
the estimation of usefulness. For this function, we may set the
proportion of selection individuals (<em>proSel</em>), the population
type (<em>Type</em>), and the generation (<em>Generation</em>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># 1. Assigning the parents</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(lines_Geno)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co"># 2. Creating the crossing plan</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># 3. Creating a relationship matrix based on markers</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (lines_Geno <span class="sc">%*%</span> <span class="fu">t</span>(lines_Geno)) <span class="sc">/</span> <span class="fu">ncol</span>(lines_Geno)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co"># 4.  Usefulness for two traits</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>Multitrait_usef <span class="ot">&lt;-</span> <span class="fu">getUsefA_mt</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>                               <span class="at">Markers =</span> lines_Geno,</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>                               <span class="at">addEff =</span> lines_addEffects,</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>                               <span class="at">Map.In =</span> lines_GenMap,</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>                               <span class="at">K =</span> relMat,</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>                               <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>                               <span class="at">Type =</span> <span class="st">&quot;RIL&quot;</span>,</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>                               <span class="at">Generation =</span> <span class="dv">1</span>,</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>                               <span class="at">Weights =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="fu">head</span>(Multitrait_usef[[<span class="dv">1</span>]], <span class="dv">10</span>)</span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt;    Cross.ID Parent1 Parent2    Mean   Variance        sd Usefulness</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; 1     G1_G2      G1      G2 2.28678 0.01126616 0.1061422    2.50572</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; 2     G2_G4      G2      G4 2.24444 0.01504070 0.1226405    2.49741</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; 3     G1_G4      G1      G4 2.24372 0.01100678 0.1049132    2.46013</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; 4     G2_G3      G2      G3 1.85493 0.03397417 0.1843208    2.23513</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; 5     G3_G4      G3      G4 1.81186 0.03789793 0.1946739    2.21342</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt; 6     G1_G3      G1      G3 1.85421 0.02578186 0.1605673    2.18541</span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#&gt; 7     G2_G5      G2      G5 1.77789 0.02448657 0.1564819    2.10067</span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co">#&gt; 8     G1_G5      G1      G5 1.77717 0.02014957 0.1419492    2.06997</span></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="co">#&gt; 9    G2_G12      G2     G12 1.71979 0.02859541 0.1691018    2.06860</span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="co">#&gt; 10   G2_G30      G2     G30 1.68297 0.03234579 0.1798494    2.05395</span></span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="fu">head</span>(Multitrait_usef[[<span class="dv">2</span>]], <span class="dv">10</span>)</span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a><span class="co">#&gt; 1       G1      G2 2.50572 1.2292683</span></span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a><span class="co">#&gt; 2       G2      G4 2.49741 1.2162602</span></span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a><span class="co">#&gt; 3       G1      G4 2.46013 1.2227642</span></span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a><span class="co">#&gt; 4       G2      G3 2.23513 0.9886179</span></span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a><span class="co">#&gt; 5       G3      G4 2.21342 0.9821138</span></span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a><span class="co">#&gt; 6       G1      G3 2.18541 1.0569106</span></span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a><span class="co">#&gt; 7       G2      G5 2.10067 1.0373984</span></span>
<span id="cb8-50"><a href="#cb8-50" tabindex="-1"></a><span class="co">#&gt; 8       G1      G5 2.06997 1.0373984</span></span>
<span id="cb8-51"><a href="#cb8-51" tabindex="-1"></a><span class="co">#&gt; 9       G2     G12 2.06860 1.0081301</span></span>
<span id="cb8-52"><a href="#cb8-52" tabindex="-1"></a><span class="co">#&gt; 10      G2     G30 2.05395 1.0471545</span></span></code></pre></div>
<p>The second part uses a criterion for each cross (usefulness in this
example) with a relationship matrix (based on markers in this example)
and creates an optimum cross-selection-based mating plan. The idea is to
restrict the levels of inbreeding, using the covariance in the
individual-cross level, and maximize the criterion used (usefulness in
this example). There is needed to set the target number of crosses in
the mating plan (<em>n.cross</em>), with the maximum and minimum number
of crosses that each parent can be part of (<em>max.cross</em> and
<em>min.cross</em>), together with the level of covariance between cross
via relationship matrix for the restriction
(<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># 1. Cross selection</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> Multitrait_usef[[<span class="dv">2</span>]],</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">10</span>,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">3</span>,</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="dv">1</span>)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y  target.K</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; 1                  1  1.92347 0.9785366</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="fu">head</span>(maxGainPlan[[<span class="dv">2</span>]], <span class="dv">10</span>)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; 1       G2      G3 2.23513 0.9886179</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; 2       G3      G4 2.21342 0.9821138</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; 3       G4     G12 2.04633 0.9886179</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; 4       G4      G6 1.99178 0.9691057</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; 5       G2     G13 1.90305 0.9560976</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; 6       G1     G13 1.88016 0.9788618</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; 7       G2     G37 1.81394 0.9365854</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; 8       G3      G5 1.71879 0.9918699</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; 9       G1     G27 1.71851 0.9983740</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; 10      G1     G71 1.71359 0.9951220</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="pt3">
<div id="optimization-usefulness-and-additivenon-additive-effects" class="section level2">
<h2>Optimization: Usefulness and additive/non-additive effects</h2>
<p>Here, we will create a mating plan based on the usefulness of a trait
with additive and dominance effects.</p>
<p>We need the crossing plan, with all individual candidates to parents.
We may use the function <code>planCross()</code> for doing so. The
parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getUsefAD()</code> to predict the
usefulness of each cross in the cross plan, using the markers, markers’
effects (additive marker effects and dominance marker effects), and the
genetic map. For this function, we may set the proportion of selection
individuals (<em>proSel</em>), the population type (<em>Type</em>), and
the generation (<em>Generation</em>).</p>
<p>There are two options for the prediction of usefulness implemented in
<strong>SimpleMating</strong>. One is based on phased haplotypes (a
marker set where we know from each chromosome the copy of the allele
came from) (<em>Method = Phased</em>). The method is a proposition that
we implemented to estimate the usefulness without the need for phased
haplotypes (<em>Method = NonPhased</em>).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co"># 1. Loading the data</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">data</span>(generic_GenMap)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">data</span>(generic_Geno)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="fu">data</span>(generic_MrkEffects)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="fu">data</span>(generic_Phasedgeno)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co"># 2. Assigning the parents</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(generic_Geno)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co"># 3. Creating the crossing plan</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co"># 4. Relationship matrix</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (generic_Geno <span class="sc">%*%</span> <span class="fu">t</span>(generic_Geno)) <span class="sc">/</span> <span class="fu">ncol</span>(generic_Geno)</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co"># 5.  The usefulness of trait number 1 - Phased</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>usef_Phased <span class="ot">&lt;-</span> <span class="fu">getUsefAD</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>                       <span class="at">Markers =</span> generic_Phasedgeno, <span class="co"># Phased haplotypes</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>                       <span class="at">addEff =</span> generic_MrkEffects[, <span class="dv">1</span>],</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>                       <span class="at">domEff =</span> generic_MrkEffects[, <span class="dv">3</span>],</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>                       <span class="at">Map.In =</span> generic_GenMap,</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>                       <span class="at">K =</span> relMat,</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>                       <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>                       <span class="at">Method =</span> <span class="st">&quot;Phased&quot;</span>)</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="fu">head</span>(usef_Phased[[<span class="dv">1</span>]], <span class="dv">10</span>)</span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt;       Cross.ID Parent1 Parent2 Total.gv      Var_A       sdA      Var_D</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt; 1  29988_30069   29988   30069  7.60248 0.02206726 0.1485505 0.05781974</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; 2  30069_30098   30069   30098  7.36695 0.02198121 0.1482606 0.06356747</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt; 3  30069_30010   30069   30010  7.47667 0.01511091 0.1229264 0.03998785</span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt; 4  30069_29766   30069   29766  7.20845 0.02948413 0.1717094 0.04573390</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt; 5  30069_29577   30069   29577  7.21645 0.01426810 0.1194492 0.03196729</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt; 6  30069_29779   30069   29779  6.92268 0.02231110 0.1493690 0.04930136</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; 7  30069_30042   30069   30042  6.50328 0.01838281 0.1355832 0.06310293</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt; 8  30069_29732   30069   29732  6.60909 0.01238753 0.1112993 0.03091797</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt; 9  30069_29765   30069   29765  6.53291 0.02205777 0.1485186 0.03718066</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt; 10 30069_29593   30069   29593  6.55606 0.01377457 0.1173651 0.03838363</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">#&gt;          sdD Usefulness</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt; 1  0.2404574    8.18549</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="co">#&gt; 2  0.2521259    7.97027</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a><span class="co">#&gt; 3  0.1999696    7.96085</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="co">#&gt; 4  0.2138548    7.77417</span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a><span class="co">#&gt; 5  0.1787940    7.65998</span></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a><span class="co">#&gt; 6  0.2220391    7.47467</span></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a><span class="co">#&gt; 7  0.2512030    7.09210</span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a><span class="co">#&gt; 8  0.1758351    7.03834</span></span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a><span class="co">#&gt; 9  0.1928229    7.03495</span></span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a><span class="co">#&gt; 10 0.1959174    7.02715</span></span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a></span>
<span id="cb11-56"><a href="#cb11-56" tabindex="-1"></a><span class="co"># 6.  The usefulness of trait number 1 - Non phased</span></span>
<span id="cb11-57"><a href="#cb11-57" tabindex="-1"></a>usefNonPhased <span class="ot">&lt;-</span> <span class="fu">getUsefAD</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb11-58"><a href="#cb11-58" tabindex="-1"></a>                           <span class="at">Markers =</span> generic_Geno, <span class="co"># non Phased markers</span></span>
<span id="cb11-59"><a href="#cb11-59" tabindex="-1"></a>                           <span class="at">addEff =</span> generic_MrkEffects[, <span class="dv">1</span>],</span>
<span id="cb11-60"><a href="#cb11-60" tabindex="-1"></a>                           <span class="at">domEff =</span> generic_MrkEffects[, <span class="dv">3</span>],</span>
<span id="cb11-61"><a href="#cb11-61" tabindex="-1"></a>                           <span class="at">Map.In =</span> generic_GenMap,</span>
<span id="cb11-62"><a href="#cb11-62" tabindex="-1"></a>                           <span class="at">K =</span> relMat,</span>
<span id="cb11-63"><a href="#cb11-63" tabindex="-1"></a>                           <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb11-64"><a href="#cb11-64" tabindex="-1"></a>                           <span class="at">Method =</span> <span class="st">&quot;NonPhased&quot;</span>)</span>
<span id="cb11-65"><a href="#cb11-65" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb11-66"><a href="#cb11-66" tabindex="-1"></a></span>
<span id="cb11-67"><a href="#cb11-67" tabindex="-1"></a><span class="fu">head</span>(usefNonPhased[[<span class="dv">1</span>]], <span class="dv">10</span>)</span>
<span id="cb11-68"><a href="#cb11-68" tabindex="-1"></a><span class="co">#&gt;       Cross.ID Parent1 Parent2 Total.gv      Var_A       sdA    Var_D      sdD</span></span>
<span id="cb11-69"><a href="#cb11-69" tabindex="-1"></a><span class="co">#&gt; 1  29988_30069   29988   30069  7.60248 0.09841212 0.3137071 3.849888 1.962113</span></span>
<span id="cb11-70"><a href="#cb11-70" tabindex="-1"></a><span class="co">#&gt; 2  30069_30098   30069   30098  7.36695 0.10418577 0.3227782 3.255957 1.804427</span></span>
<span id="cb11-71"><a href="#cb11-71" tabindex="-1"></a><span class="co">#&gt; 3  30069_29766   30069   29766  7.20845 0.10372587 0.3220650 2.972838 1.724192</span></span>
<span id="cb11-72"><a href="#cb11-72" tabindex="-1"></a><span class="co">#&gt; 4  30069_29577   30069   29577  7.21645 0.06916419 0.2629909 2.683442 1.638121</span></span>
<span id="cb11-73"><a href="#cb11-73" tabindex="-1"></a><span class="co">#&gt; 5  30069_30010   30069   30010  7.47667 0.10894299 0.3300651 2.219524 1.489807</span></span>
<span id="cb11-74"><a href="#cb11-74" tabindex="-1"></a><span class="co">#&gt; 6  30069_29760   30069   29760  6.48958 0.06908177 0.2628341 3.109599 1.763406</span></span>
<span id="cb11-75"><a href="#cb11-75" tabindex="-1"></a><span class="co">#&gt; 7  30069_29779   30069   29779  6.92268 0.08722246 0.2953345 2.276488 1.508803</span></span>
<span id="cb11-76"><a href="#cb11-76" tabindex="-1"></a><span class="co">#&gt; 8  30069_29765   30069   29765  6.53291 0.10405690 0.3225785 2.858590 1.690737</span></span>
<span id="cb11-77"><a href="#cb11-77" tabindex="-1"></a><span class="co">#&gt; 9  30069_29406   30069   29406  6.28254 0.08670396 0.2944554 2.879325 1.696858</span></span>
<span id="cb11-78"><a href="#cb11-78" tabindex="-1"></a><span class="co">#&gt; 10 30069_29593   30069   29593  6.55606 0.09917756 0.3149247 2.342416 1.530495</span></span>
<span id="cb11-79"><a href="#cb11-79" tabindex="-1"></a><span class="co">#&gt;    Usefulness</span></span>
<span id="cb11-80"><a href="#cb11-80" tabindex="-1"></a><span class="co">#&gt; 1    11.70116</span></span>
<span id="cb11-81"><a href="#cb11-81" tabindex="-1"></a><span class="co">#&gt; 2    11.14805</span></span>
<span id="cb11-82"><a href="#cb11-82" tabindex="-1"></a><span class="co">#&gt; 3    10.82648</span></span>
<span id="cb11-83"><a href="#cb11-83" tabindex="-1"></a><span class="co">#&gt; 4    10.63869</span></span>
<span id="cb11-84"><a href="#cb11-84" tabindex="-1"></a><span class="co">#&gt; 5    10.62423</span></span>
<span id="cb11-85"><a href="#cb11-85" tabindex="-1"></a><span class="co">#&gt; 6    10.16716</span></span>
<span id="cb11-86"><a href="#cb11-86" tabindex="-1"></a><span class="co">#&gt; 7    10.09397</span></span>
<span id="cb11-87"><a href="#cb11-87" tabindex="-1"></a><span class="co">#&gt; 8    10.08332</span></span>
<span id="cb11-88"><a href="#cb11-88" tabindex="-1"></a><span class="co">#&gt; 9     9.83498</span></span>
<span id="cb11-89"><a href="#cb11-89" tabindex="-1"></a><span class="co">#&gt; 10    9.77917</span></span></code></pre></div>
<p>The second part uses using criterion for each cross (usefulness in
this example) with a relationship matrix (based on markers in this
example) and creates an optimum cross-selection-based mating plan. The
idea is to restrict the levels of inbreeding, utilizing the covariance
in the individual-cross level, and maximize the criterion used
(usefulness in this example). There is needed to set the target number
of crosses in the mating plan (<em>n.cross</em>), with the maximum and
minimum number of crosses that each parent can be part of
(<em>max.cross</em> and <em>min.cross</em>), together with the level of
covariance between cross via relationship matrix for the restriction
(<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned. The same step-by-step approach can be implemented for several
traits (using the function <code>getUsefAD_mt()</code>)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># 1. Cross selection</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> usef_Phased[[<span class="dv">2</span>]],</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">25</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">5</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="dv">1</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y  target.K</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; 1                  1 5.685254 0.9822778</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; 1    29988   30069 8.18549 0.9819444</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; 2    30069   30098 7.97027 0.9645833</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; 3    30069   30010 7.96085 0.9750000</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; 4    30069   29766 7.77417 0.9979167</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; 5    30069   29779 7.47467 0.9923611</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; 6    29779   29193 5.72334 0.9777778</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; 7    29406   29577 5.61338 0.9951389</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; 8    30098   29577 5.57755 0.9833333</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; 9    29779   29141 5.48698 0.9736111</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; 10   29141   29574 5.38015 0.9694444</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; 11   29426   29577 5.29153 0.9611111</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt; 12   29577   30010 5.25388 0.9708333</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt; 13   29766   29193 5.18111 0.9944444</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; 14   29766   29805 5.15846 0.9916667</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; 15   29766   30010 5.13237 0.9680556</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt; 16   29406   30098 5.06658 0.9951389</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="co">#&gt; 17   30098   29141 5.03607 0.9888889</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co">#&gt; 18   29779   30042 5.03320 0.9951389</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co">#&gt; 19   29577   29629 4.93852 0.9875000</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co">#&gt; 20   29975   30010 4.88606 0.9937500</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co">#&gt; 21   29141   30010 4.85559 0.9784722</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="co">#&gt; 22   29766   29804 4.82440 0.9437500</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a><span class="co">#&gt; 23   29779   30098 4.81695 0.9944444</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co">#&gt; 24   29988   29193 4.78624 0.9986111</span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="co">#&gt; 25   29141   29253 4.72355 0.9840278</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="pt4">
<div id="optimization-using-cross-total-genetic-value" class="section level2">
<h2>Optimization: Using cross total genetic value</h2>
<p>Here, we will create a mating plan through an optimization based on
the total genetic value for one trait controlled by additive and
dominance effects, using molecular markers.</p>
<p>We need the crossing plan, with all individual candidates to parents.
We may use the function <code>planCross()</code> for doing so. The
parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getTGV()</code> to predict the total
genetic value for each cross in the cross plan, using the markers,
markers’ effects, and the relationship matrix to generate the input for
the new optimization function itself.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># 1. Loading the data</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="fu">data</span>(generic_GenMap)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="fu">data</span>(generic_Geno)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">data</span>(generic_MrkEffects)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co"># 2. Creating a relationship matrix based on markers</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (generic_Geno <span class="sc">%*%</span> <span class="fu">t</span>(generic_Geno)) <span class="sc">/</span> <span class="fu">ncol</span>(generic_Geno)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co"># 3. Assigning parents</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(generic_Geno)</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co"># 4. Creating the crossing plan</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co"># 5. Estimates the total genetic value for the progenies of each cross</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>total_gv <span class="ot">&lt;-</span> <span class="fu">getTGV</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>                   <span class="at">Markers =</span> generic_Geno,</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>                   <span class="at">addEff =</span> generic_MrkEffects[, <span class="dv">1</span>],</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>                   <span class="at">domEff =</span> generic_MrkEffects[, <span class="dv">3</span>],</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>                   <span class="at">K =</span> relMat,</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>                   <span class="at">ploidy =</span> <span class="dv">2</span>)</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; TGVs predicted for 4950 crosses.</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="fu">head</span>(total_gv, <span class="dv">10</span>)</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt; 1    29121   29138 0.94021 1.1222222</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt; 2    29121   29141 3.82345 0.9694444</span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt; 3    29121   29173 3.27528 0.9618056</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt; 4    29121   29174 2.46291 0.9472222</span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt; 5    29121   29179 3.63474 0.9548611</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt; 6    29121   29193 3.33305 1.0020833</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt; 7    29121   29205 1.54588 1.0201389</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt; 8    29121   29213 2.04343 1.0395833</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt; 9    29121   29233 2.06714 1.0194444</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="co">#&gt; 10   29121   29245 2.34731 0.9881944</span></span></code></pre></div>
<p>The second part uses a criterion for each cross (total genetic value
in this example) with a relationship matrix (based on markers in this
example) and creates an optimum cross-selection-based mating plan. The
idea is to restrict the levels of inbreeding, using the covariance in
the individual-cross level, and maximize the criterion used (total
genetic value in this example). There is needed to set the target number
of crosses in the mating plan (<em>n.cross</em>), with the maximum and
minimum number of crosses that each parent can be part of
(<em>max.cross</em> and <em>min.cross</em>), together with the level of
covariance between cross via relationship matrix for the restriction
(<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co"># 1. Crosses selected</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> total_gv,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">25</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">10</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="fl">1.1</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y  target.K</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; 1                1.1 5.929714 0.9994167</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; 1    29988   30069 7.60248 0.9819444</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 2    30069   30010 7.47667 0.9750000</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; 3    30069   30098 7.36695 0.9645833</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; 4    30069   29577 7.21645 1.0034722</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; 5    30069   29766 7.20845 0.9979167</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; 6    30069   29779 6.92268 0.9923611</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; 7    30069   29732 6.60909 0.9736111</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; 8    30069   29593 6.55606 1.0222222</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; 9    30069   29765 6.53291 0.9569444</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; 10   30069   29776 6.50338 1.0041667</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="co">#&gt; 11   29988   29593 5.79058 1.0680556</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; 12   29577   29141 5.45943 1.0013889</span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a><span class="co">#&gt; 13   29766   29577 5.45905 1.0722222</span></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a><span class="co">#&gt; 14   29406   29577 5.39024 0.9951389</span></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a><span class="co">#&gt; 15   29988   29577 5.31732 1.0236111</span></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a><span class="co">#&gt; 16   29779   29193 5.26292 0.9777778</span></span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a><span class="co">#&gt; 17   30098   29577 5.24666 0.9833333</span></span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a><span class="co">#&gt; 18   29988   30098 5.16477 1.0756944</span></span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a><span class="co">#&gt; 19   29426   29577 5.15370 0.9611111</span></span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a><span class="co">#&gt; 20   29988   29805 5.09140 1.0027778</span></span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a><span class="co">#&gt; 21   29577   30010 5.04938 0.9708333</span></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a><span class="co">#&gt; 22   29577   29975 4.99133 1.0256944</span></span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a><span class="co">#&gt; 23   29141   29574 4.97513 0.9694444</span></span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a><span class="co">#&gt; 24   29779   29141 4.96099 0.9736111</span></span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a><span class="co">#&gt; 25   29988   29406 4.93483 1.0125000</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="pt5">
<div id="optimization-using-the-mid-parental-value" class="section level2">
<h2>Optimization: Using the Mid-Parental Value</h2>
<p>Here, we will create a mating plan through optimization based on the
Mid-Parental Value for one additive trait using pedigree
information.</p>
<p>We need the crossing plan, with all individual candidates to parents.
We may use the function <code>planCross()</code> for doing so. The
parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). Then, we need to
organize the dataset for the predictions. The input to calculate the
Mid-Parental Value is a two-column data frame, where in the first row we
have the individual’s identification (same names that we find in the
cross plan), and the criterion. By criterion, you can specify the
estimated breeding value (EBV) or even the best linear unbiased
prediction (BLUP) of each individual. This allows us to use this
function for polyploid individuals, for example. In this case, we can
make the predictions and input the values to calculate the expected
Mid-Parental Value for each cross.</p>
<p>The upcoming step is to use the function <code>getMPA()</code> to
predict the Mid-Parental Value for each cross in the cross plan, using
the BLUP information from each individual. The relationship matrix based
on pedigree (in this case) is used to restrict inbreeding. You can use
the relationship matrix based on markers, instead of the pedigree-based
matrix. We will use the package <strong>AGHmatrix</strong> for that
(Amadeu et al. 2022).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co"># 1. Loading the information</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="fu">data</span>(generic_Pedigree)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="fu">data</span>(generic_IndBLUP)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">data</span>(generic_Geno)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co"># 2. Using AGHMatrix to build the G matrix</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>AMat <span class="ot">&lt;-</span> AGHmatrix<span class="sc">::</span><span class="fu">Amatrix</span>(<span class="at">data =</span> generic_Pedigree)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; Verifying conflicting data... </span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; Organizing data... </span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; Your data was chronologically organized with success. </span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; Constructing matrix A using ploidy = 2 </span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; Completed! Time = 0.0003333333  minutes</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co"># 3. Assigning parents</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(generic_Geno)</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co"># 4. Creating the mating plan</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>CrossPlan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>                       <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co"># 5. Criterion</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>Crit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Id =</span> generic_IndBLUP[,<span class="dv">1</span>],</span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>                   <span class="at">Criterion =</span> generic_IndBLUP[, <span class="dv">2</span>])</span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co"># 6.Single trait mean parental average</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a>ST_mpv <span class="ot">&lt;-</span> <span class="fu">getMPV</span>(<span class="at">MatePlan =</span> CrossPlan,</span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a>                 <span class="at">Criterion =</span> Crit,</span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a>                 <span class="at">K =</span> AMat)</span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="co">#&gt; 4950 possible crosses were predicted</span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="fu">head</span>(ST_mpv, <span class="dv">20</span>)</span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2        Y K</span></span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a><span class="co">#&gt; 1    29988   30069 175.1673 0</span></span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a><span class="co">#&gt; 2    30069   29406 173.9280 0</span></span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a><span class="co">#&gt; 3    30069   29551 169.9036 0</span></span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a><span class="co">#&gt; 4    30069   30098 169.8895 0</span></span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a><span class="co">#&gt; 5    30069   29768 169.8379 0</span></span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a><span class="co">#&gt; 6    30069   29766 169.4261 0</span></span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a><span class="co">#&gt; 7    30069   29426 169.2966 0</span></span>
<span id="cb17-44"><a href="#cb17-44" tabindex="-1"></a><span class="co">#&gt; 8    29988   29406 169.0046 0</span></span>
<span id="cb17-45"><a href="#cb17-45" tabindex="-1"></a><span class="co">#&gt; 9    30069   29497 168.9645 0</span></span>
<span id="cb17-46"><a href="#cb17-46" tabindex="-1"></a><span class="co">#&gt; 10   30069   29898 168.8804 0</span></span>
<span id="cb17-47"><a href="#cb17-47" tabindex="-1"></a><span class="co">#&gt; 11   30069   29577 168.2743 0</span></span>
<span id="cb17-48"><a href="#cb17-48" tabindex="-1"></a><span class="co">#&gt; 12   30069   29760 168.2431 0</span></span>
<span id="cb17-49"><a href="#cb17-49" tabindex="-1"></a><span class="co">#&gt; 13   30069   29791 168.1582 0</span></span>
<span id="cb17-50"><a href="#cb17-50" tabindex="-1"></a><span class="co">#&gt; 14   30069   29372 167.7388 0</span></span>
<span id="cb17-51"><a href="#cb17-51" tabindex="-1"></a><span class="co">#&gt; 15   30069   29975 167.4502 0</span></span>
<span id="cb17-52"><a href="#cb17-52" tabindex="-1"></a><span class="co">#&gt; 16   30069   29529 167.2337 0</span></span>
<span id="cb17-53"><a href="#cb17-53" tabindex="-1"></a><span class="co">#&gt; 17   30069   29601 167.1417 0</span></span>
<span id="cb17-54"><a href="#cb17-54" tabindex="-1"></a><span class="co">#&gt; 18   30069   29141 167.0200 0</span></span>
<span id="cb17-55"><a href="#cb17-55" tabindex="-1"></a><span class="co">#&gt; 19   30069   29121 166.8110 0</span></span>
<span id="cb17-56"><a href="#cb17-56" tabindex="-1"></a><span class="co">#&gt; 20   30069   29792 166.7701 0</span></span></code></pre></div>
<p>The second part uses a criterion for each cross (Mid-Parental Value
in this example) with a relationship matrix (based on pedigree
information in this example) and creates an optimum
cross-selection-based mating plan. The idea is to restrict the levels of
inbreeding, utilizing the covariance in the individual-cross level, and
maximize the criterion used (Mid-Parental Value in this example). There
is needed to set the target number of crosses in the mating plan
(<em>n.cross</em>), with the maximum and minimum number of crosses that
each parent can be part of (<em>max.cross</em> and <em>min.cross</em>),
together with the level of covariance between cross via relationship
matrix for the restriction (<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># 1. Crosses selected</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> ST_mpv,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">25</span>,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">10</span>,</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="fl">0.21</span>)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y target.K</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; 1               0.21   166.72        0</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2        Y K</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; 1    29988   30069 175.1673 0</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; 2    30069   29406 173.9280 0</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; 3    30069   29551 169.9036 0</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; 4    30069   30098 169.8895 0</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; 5    30069   29768 169.8379 0</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; 6    30069   29766 169.4261 0</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; 7    30069   29426 169.2966 0</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; 8    29988   29406 169.0046 0</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; 9    30069   29497 168.9645 0</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; 10   30069   29898 168.8804 0</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">#&gt; 11   30069   29577 168.2743 0</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co">#&gt; 12   29988   29551 164.9802 0</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt; 13   29988   30098 164.9661 0</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="co">#&gt; 14   29988   29768 164.9145 0</span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="co">#&gt; 15   29988   29766 164.5027 0</span></span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a><span class="co">#&gt; 16   29988   29426 164.3733 0</span></span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a><span class="co">#&gt; 17   29988   29497 164.0412 0</span></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a><span class="co">#&gt; 18   29988   29898 163.9571 0</span></span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a><span class="co">#&gt; 19   29406   29551 163.7409 0</span></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="co">#&gt; 20   29406   30098 163.7268 0</span></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a><span class="co">#&gt; 21   29406   29768 163.6752 0</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a><span class="co">#&gt; 22   29988   29577 163.3510 0</span></span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a><span class="co">#&gt; 23   29406   29766 163.2634 0</span></span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a><span class="co">#&gt; 24   29406   29426 163.1340 0</span></span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a><span class="co">#&gt; 25   29406   29497 162.8019 0</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="pt6">
<div id="optimization-using-the-linkage-disequilibrium-to-predicts-the-crosses-variance" class="section level2">
<h2>Optimization: Using the linkage disequilibrium to predicts the
crosses variance</h2>
<p>From the original proposition, a genetic map (the input in the
Haldane function to estimate the recombination rates in the population)
is required (Lehermeier et al. 2017) for the estimation of cross
variance. In addition, it is not straightforward to have a genetic map
that represents the target population under study. In this way, we
replace the information of the matrix with the recombination frequencies
between pairs of SNPs by the linkage disequilibrium (LD) matrix. It is
known that the the LD varies from 0-1 in a population, being values
close to an integer the recombination is low and when it is close to
zero, the recombination frequency is high. Linkage disequilibrium can be
estimated from a markers matrix (with or without phasing information).
It was implemented in the function that estimates the usefulness
(<code>getUsefA</code>, <code>getUsefAD</code>,
<code>getUsefA_mt</code>, and <code>getUsefAD_mt</code>) the estimation
of the cross variance and, ultimately, the cross usefulness by using the
LD matrix. By doing so, the user may give the LD matrix in the argument
<code>linkDes</code> and give the chromosome and the SNP id in the
argument <code>Map.In</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co"># 1. Load data</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">data</span>(lines_Geno)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co"># 2. Assuming a naive LD measure</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>linkageDes <span class="ot">&lt;-</span> (<span class="fu">t</span>(lines_Geno) <span class="sc">%*%</span> lines_Geno)<span class="sc">/</span>(<span class="fu">ncol</span>(lines_Geno))</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co"># 3. Creating relationship matrix based on markers</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (lines_Geno <span class="sc">%*%</span> <span class="fu">t</span>(lines_Geno)) <span class="sc">/</span> <span class="fu">ncol</span>(lines_Geno)</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co"># 4. Assigning the parents</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(lines_Geno)</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co"># 5. Creating the crossing plan</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co"># 6. Information on the SNPs</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>mapInfo <span class="ot">=</span> lines_GenMap[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="co"># 7.  Usefulness of trait number 1 (DH)</span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>usef_add <span class="ot">&lt;-</span> <span class="fu">getUsefA</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>                     <span class="at">Markers =</span> lines_Geno,</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>                     <span class="at">addEff =</span> lines_addEffects[, <span class="dv">1</span>],</span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>                     <span class="at">Map.In =</span> mapInfo,</span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a>                     <span class="at">linkDes =</span> linkageDes,</span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>                     <span class="at">K =</span> relMat,</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a>                     <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a>                     <span class="at">Type =</span> <span class="st">&quot;DH&quot;</span>,</span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a>                     <span class="at">Generation =</span> <span class="dv">1</span>)</span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a><span class="fu">head</span>(usef_add[[<span class="dv">1</span>]], <span class="dv">10</span>)</span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a><span class="co">#&gt;    Cross.ID Parent1 Parent2    Mean  Variance        sd Usefulness</span></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a><span class="co">#&gt; 1     G1_G2      G1      G2 4.51880 0.1205174 0.3471562    5.23488</span></span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a><span class="co">#&gt; 2     G2_G3      G2      G3 4.01124 0.3289240 0.5735190    5.19424</span></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a><span class="co">#&gt; 3     G1_G3      G1      G3 4.10644 0.2206587 0.4697432    5.07539</span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a><span class="co">#&gt; 4     G1_G4      G1      G4 4.27818 0.1269868 0.3563520    5.01323</span></span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a><span class="co">#&gt; 5     G2_G4      G2      G4 4.18298 0.1609132 0.4011399    5.01042</span></span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a><span class="co">#&gt; 6     G3_G4      G3      G4 3.77061 0.3408383 0.5838136    4.97485</span></span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a><span class="co">#&gt; 7     G1_G5      G1      G5 3.48462 0.3643654 0.6036268    4.72973</span></span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a><span class="co">#&gt; 8     G2_G5      G2      G5 3.38943 0.4088559 0.6394184    4.70837</span></span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a><span class="co">#&gt; 9     G1_G9      G1      G9 3.04164 0.6263750 0.7914386    4.67415</span></span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a><span class="co">#&gt; 10   G1_G24      G1     G24 3.09747 0.5749812 0.7582751    4.66157</span></span></code></pre></div>
</div>
<div id="pt7">
<div id="thinning-by-relatedness-how-to-speed-up-prediction" class="section level2">
<h2>Thinning by relatedness: How to speed up prediction</h2>
<p>The <em>relateThinning()</em> is an optional step and it will
increase the efficiency of the prediction by cutting individuals by
relatedness and, consequently, decrease the time for the prediction of
usefulness and cross-optimization. It selects the top individuals within
a family by the relatedness <code>threshold</code>. For example, if
<code>max.per.cluster=4</code> and <code>threshold = 0.1</code> the
algorithm will identify all groups of individuals that shared more than
0.1 in the relationship matrix and select the top 4 individuals with the
highest criterion to be used as possible parents in the mating plan.
Besides those arguments, we need to give to the function the
relationship matrix (<code>K</code>) between the parents. It could be
the relationship matrix based on markers information (G) or based on
pedigree information (A). In addition, a <code>criterion</code> should
be added, such as the estimated breeding value, total breeding value, or
the BLUP of the candidates (not the cross as before).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co"># 1. Loading the data</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">data</span>(generic_Geno)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="fu">data</span>(generic_IndBLUP)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co"># 2. Creating relationship matrix based on markers</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>ScaledMarkers <span class="ot">=</span> <span class="fu">scale</span>(generic_Geno, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (ScaledMarkers <span class="sc">%*%</span> <span class="fu">t</span>(ScaledMarkers)) <span class="sc">/</span> <span class="fu">ncol</span>(ScaledMarkers)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co"># 3. Criterion for the trait</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>Crit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Id =</span> <span class="fu">rownames</span>(generic_IndBLUP),</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>                   <span class="at">Criterion =</span> generic_IndBLUP[, <span class="dv">2</span>]) <span class="co"># trait number one</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>                    </span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co"># 4. Trimming by relatedness</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="fu">relateThinning</span>(<span class="at">K =</span> relMat,</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>                      <span class="at">Criterion =</span> Crit,</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>                      <span class="at">threshold=</span><span class="fl">0.1</span>,</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>                      <span class="at">max.per.cluster=</span><span class="dv">4</span>)</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt; 93 genotypes kept out of 100</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co"># 5. Crossing plan using the argument Indiv2keep</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> <span class="fu">colnames</span>(relMat),</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>                 <span class="at">MateDesign =</span> <span class="st">&#39;half&#39;</span>,</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a>                 <span class="at">Indiv2keep =</span> keep)</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4278</span></span></code></pre></div>
<p>As a result, we kept 93 individuals out of 100 individuals. In such
case, we will predict usefulness or mean parental average/total genetic
value for 4278 crosses instead of 4950 crosses (the number of crosses
resulted from the matching of 100 individuals). When we have a large
number of parents, such as 2000 individuals as candidates to parents,
the function can be used to decrease the time for prediction and
optimization.</p>
</div>
<div id="bibliography" class="section level2">
<h2>Bibliography</h2>
<p>Akdemir &amp; Sánchez (2016). Efficient breeding by genomic mating.
Frontiers in Genetics. <a href="https://doi.org/10.3389/fgene.2016.00210" class="uri">https://doi.org/10.3389/fgene.2016.00210</a><br />
Allier et al. (2019). Usefulness criterion and post-selection parental
contributions in multi-parental crosses: Application to polygenic trait
introgression. G3: Genes, Genomes, Genetics. <a href="https://doi.org/10.1534/g3.119.400129" class="uri">https://doi.org/10.1534/g3.119.400129</a><br />
Bonk et al. (2016). Mendelian sampling covariability of marker effects
and genetic values. Genetics Selection Evolution. <a href="https://gsejournal.biomedcentral.com/articles/10.1186/s12711-016-0214-0" class="uri">https://gsejournal.biomedcentral.com/articles/10.1186/s12711-016-0214-0</a><br />
Lehermeier (2017). Genetic gain increases by applying the usefulness
criterion with improved variance prediction in selection of crosses.
Genetics. <a href="https://doi.org/10.1534/genetics.117.300403" class="uri">https://doi.org/10.1534/genetics.117.300403</a><br />
Schnell &amp; Utz (1976). F1 Leistung und Elternwahl in der Zuchtung von
Selbstbefruchtern. Ber Arbeitstag Arbeitsgem Saatzuchtleiter.<br />
Toro &amp; Varona (2010). A note on mate allocation for dominance
handling in genomic selection. Genetics Selection Evolution. <a href="https://doi.org/10.1186/1297-9686-42-33" class="uri">https://doi.org/10.1186/1297-9686-42-33</a><br />
Varona et al. (2018). Non-additive effects in genomic selection.
Frontiers in Genetics. <a href="https://doi.org/10.3389/fgene.2018.00078" class="uri">https://doi.org/10.3389/fgene.2018.00078</a><br />
Wolfe et al. (2021). Genomic mating in outbred species: Predicting cross
usefulness with additive and total genetic covariance matrices.
Genetics. <a href="https://doi.org/10.1093/genetics/iyab122" class="uri">https://doi.org/10.1093/genetics/iyab122</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
