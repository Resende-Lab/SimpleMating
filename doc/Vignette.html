<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Marco Antonio Peixoto" />

<meta name="date" content="2024-01-12" />

<title>SimpleMating: A R package to breeding crosses optimization</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">SimpleMating: A R package to breeding
crosses optimization</h1>
<h4 class="author">Marco Antonio Peixoto</h4>
<h4 class="date">2024-01-12</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><strong>SimpleMating</strong> predicts cross usefulness (cross mean
and variance) and creates a mating plan based on the balancing of
usefulness and inbreeding, through optimum cross selection. It has two
modules:<br />
i. Cross prediction;<br />
ii. Mating optimization.</p>
<p>In this tutorial we will explain the implementation of both modules.
It is worth mentioning is that the prediction of usefulness is not
needed for the optimization. If only genetic values (BLUP, for example)
and a relationship matrix is given (pedigree- or marker-based
relationship matrix) for the parents, we can implement the optimization.
However, it has been shown that use usefulness may improve the genetic
gain in the long term for several crops.</p>
</div>
<div id="input-files" class="section level2">
<h2>Input files</h2>
<p>Four files are needed but not all required, to run an analyses in
<strong>SimpleMating</strong>:</p>
<ol style="list-style-type: lower-roman">
<li>Matrix with markers from the parental population;<br />
</li>
<li>markers effects for the target trait (or traits);<br />
</li>
<li>Genetic map for recombination estimation;<br />
</li>
<li>relationship matrix (pedigree- or marker-based).</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># 1. Install and require the package</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># install.packages(SimpleMating)</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; Loading required package: SimpleMating</span></span></code></pre></div>
<div id="marker-matrix" class="section level4">
<h4>1) Marker matrix</h4>
<p>The marker matrix has the information of genotypes in the lines and
the information of SNPs in the columns, coded as 0,1,2 meaning the
number of copies of the alternative allele that is presented for each
loci.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Marker matrix</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">data</span>(lines_geno)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>lines_geno[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;    SNP1 SNP2 SNP3 SNP4 SNP5 SNP6 SNP7 SNP8 SNP9 SNP10</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; G1    0    0    0    0    0    2    0    0    0     0</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; G2    0    2    0    0    0    2    0    0    0     0</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; G3    0    0    0    0    2    2    0    0    2     0</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; G4    0    2    0    0    2    2    0    0    2     2</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; G5    0    0    0    0    2    2    0    0    0     0</span></span></code></pre></div>
</div>
<div id="marker-effects" class="section level4">
<h4>2) Marker effects</h4>
<p>This is a data frame with the information of the effects for each
marker from the matrix before mentioned. In this case, each row
represents one marker and each column one trait (two traits and 1230
markers).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Marker Effects</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">data</span>(lines_addEffects)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">head</span>(lines_addEffects)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;          Trait1       Trait2</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 1  0.0040766216 -0.009966711</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 2 -0.0289548681 -0.005755768</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 3  0.0004455079  0.003503013</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 4 -0.0160739676  0.006416368</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 5 -0.0391649099 -0.007403514</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 6 -0.0111279275  0.002048055</span></span></code></pre></div>
</div>
<div id="genetic-map" class="section level4">
<h4>3) Genetic map</h4>
<p>The genetic map is a data frame with the information about position,
in the genome, of the markers. There are three columns in the file,
being the first the chromosome, the second represents the actual
position of the marker (in centimorgan), and the third is the marker
name.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Genetic Map</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">data</span>(lines_GenMap)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">head</span>(lines_GenMap)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt;   chr        pos  mkr</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 1   1  0.2764759  1_2</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 2   1  3.3216417 1_11</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 3   1  6.7868549 1_20</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 4   1  8.2184291 1_22</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 5   1 10.3991024 1_27</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; 6   1 14.6535342 1_36</span></span></code></pre></div>
</div>
<div id="relationship-matrix" class="section level4">
<h4>4) Relationship matrix</h4>
<p>For the optimization itself, to restrict inbreeding levels, we need a
relationship matrix. It could be a numerator relationship matrix based
on pedigree data or a realized relationship matrix based on markers.</p>
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>We going to cover four examples, as follows:</p>
<ol style="list-style-type: decimal">
<li>Optimization based on usefulness for one additive trait using
molecular markers. <a href="#pt1">shortcut</a><br />
</li>
<li>Optimization based on usefulness for two additive traits using
molecular markers. <a href="#pt2">shortcut</a><br />
</li>
<li>Optimization based on usefulness for one additive/dominance trait
using molecular markers. <a href="#pt3">shortcut</a><br />
</li>
<li>Optimization based on total genetic value for one additive trait
using molecular markers. <a href="#pt4">shortcut</a><br />
</li>
<li>Optimization based on mean parental average for one additive trait
using pedigree information. <a href="#pt5">shortcut</a></li>
</ol>
<div id="pt1"></div>

</div>
<div id="optimization-usefulness-on-additive-trait" class="section level2">
<h2>Optimization: Usefulness on additive trait</h2>
<p>Here, we will create a mating plan based on usefulness for one
additive trait.</p>
<p>We need the cross plan, with all individuals candidates to be
parents. We may use the function <code>planCross()</code> for doing so.
The parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getUsefA()</code> to predict the
usefulness for each cross in the cross plan, using the markers, markers’
effects, and the genetic map. For this function, we may set the
proportion of selection individuals (<em>proSel</em>), the population
type (<em>Type</em>), and the generation (<em>Generation</em>).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># 1. Assigning the parents</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(lines_geno)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># 2. Creating the cross plan</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co"># 3.  Usefulness of trait number 1 (DH)</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>usef_add <span class="ot">&lt;-</span> <span class="fu">getUsefA</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>                     <span class="at">Markers =</span> lines_geno,</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>                     <span class="at">addEff =</span> lines_addEffects[, <span class="dv">1</span>],</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>                     <span class="at">Map.In =</span> lines_GenMap,</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>                     <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>                     <span class="at">Type =</span> <span class="st">&quot;DH&quot;</span>,</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>                     <span class="at">Generation =</span> <span class="dv">1</span>)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="fu">head</span>(usef_add, <span class="dv">10</span>)</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt;    Cross.ID Parent1 Parent2    Mean  Variance        sd Usefulness</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; 1     G1_G2      G1      G2 7.83137 0.3439830 0.5865006    9.04115</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; 2    G1_G15      G1     G15 7.33800 0.4721310 0.6871179    8.75533</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; 3     G1_G5      G1      G5 7.12472 0.4438526 0.6662226    8.49895</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; 4    G1_G10      G1     G10 6.73722 0.6087211 0.7802058    8.34656</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt; 5     G1_G4      G1      G4 6.87759 0.4852739 0.6966161    8.31451</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; 6    G1_G11      G1     G11 6.65338 0.6188332 0.7866595    8.27603</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt; 7     G1_G9      G1      G9 6.46663 0.4996188 0.7068372    7.92463</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="co">#&gt; 8    G1_G16      G1     G16 6.09768 0.7107230 0.8430439    7.83664</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co">#&gt; 9    G1_G28      G1     G28 6.16417 0.6354569 0.7971555    7.80847</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="co">#&gt; 10   G1_G21      G1     G21 6.00259 0.7636054 0.8738452    7.80508</span></span></code></pre></div>
<p>The second part is using criterion for each cross (usefulness in this
example) together with a relationship matrix (based on markers in this
example) and create a optimum cross selection-based mating plan. The
idea is to restrict the levels of inbreeding, by means of the covariance
in the individual-cross level, and maximize the criterion used
(usefulness in this example). There is needed to set the target number
of crosses in the mating plan (<em>n.cross</em>), with the maximum and
minimum number of crosses that each parent can be part of
(<em>max.cross</em> and <em>min.cross</em>), together with the level of
covariance between cross via relationship matrix for the restriction
(<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># 1. Creating a relationship matrix from markers</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (lines_geno <span class="sc">%*%</span> <span class="fu">t</span>(lines_geno)) <span class="sc">/</span> <span class="fu">ncol</span>(lines_geno)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># 2. Generating the input for the optimization</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>MatingCrosses <span class="ot">&lt;-</span> <span class="fu">usef2Crosses</span>(<span class="at">Usefulness =</span> usef_add, <span class="at">K =</span> relMat)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># 3. Crosses selected</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> MatingCrosses[[<span class="dv">1</span>]],</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                             <span class="at">K =</span> relMat,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">10</span>,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">3</span>,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="fl">0.8</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y  target.K</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; 1                0.8 7.219883 0.8760577</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; 1       G1     G15 8.75533 0.7674797</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; 2       G1      G5 8.49895 0.7642276</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; 3       G1     G10 8.34656 0.7642276</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; 4       G2     G15 7.35973 0.7772358</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; 5       G2      G5 7.05775 0.7967480</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; 6       G2     G10 6.96457 0.7934959</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; 7       G5     G15 6.76447 0.7739837</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; 8       G5     G10 6.41159 0.7967480</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; 9       G5     G11 6.18929 0.7479675</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; 10      G3     G15 5.85059 0.7934959</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="pt2"></div>

</div>
<div id="optimization-usefulness-on-multi-traits-scenario" class="section level2">
<h2>Optimization: Usefulness on Multi traits scenario</h2>
<p>Here, we will create a mating plan based on usefulness for two
additive traits.</p>
<p>We need the cross plan, with all individuals candidates to be
parents. We may use the function <code>planCross()</code> for doing so.
The parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getUsefA_mt()</code> to predict the
usefulness for each cross in the cross plan, using the markers, markers’
effects, and the genetic map. In addition, we need to set weights for
each trait (<em>Weights</em>), in a way to build a trait-based index for
the estimation of usefulness. For this function, we may set the
proportion of selection individuals (<em>proSel</em>), the population
type (<em>Type</em>), and the generation (<em>Generation</em>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># 1. Assigning the parents</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(lines_geno)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># 2. Creating the mating plan</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co"># 3.  Usefulness for two traits</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>Multitrait_usef <span class="ot">&lt;-</span> <span class="fu">getUsefA_mt</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>                               <span class="at">Markers =</span> lines_geno,</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>                               <span class="at">addEff =</span> lines_addEffects,</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>                               <span class="at">Map.In =</span> lines_GenMap,</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>                               <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>                               <span class="at">Type =</span> <span class="st">&quot;RIL&quot;</span>,</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>                               <span class="at">Generation =</span> <span class="dv">1</span>,</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>                               <span class="at">Weights =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="fu">head</span>(Multitrait_usef, <span class="dv">10</span>)</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt;    Cross.ID Parent1 Parent2    Mean   Variance        sd Usefulness</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; 1     G1_G2      G1      G2 3.73419 0.05010596 0.2238436    4.19592</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; 2     G1_G6      G1      G6 3.24414 0.07535322 0.2745054    3.81037</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; 3    G1_G13      G1     G13 3.25875 0.05787387 0.2405699    3.75498</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; 4     G1_G3      G1      G3 3.17315 0.07936545 0.2817187    3.75425</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; 5    G1_G20      G1     G20 3.02614 0.07959225 0.2821210    3.60807</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; 6     G1_G9      G1      G9 2.98447 0.08212233 0.2865699    3.57558</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; 7    G1_G11      G1     G11 2.94625 0.09203602 0.3033744    3.57202</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; 8    G1_G23      G1     G23 2.94653 0.08249573 0.2872207    3.53898</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; 9    G1_G12      G1     G12 2.87925 0.08863886 0.2977228    3.49337</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; 10   G1_G17      G1     G17 2.89075 0.08368850 0.2892897    3.48747</span></span></code></pre></div>
<p>The second part is using criterion for each cross (usefulness in this
example) together with a relationship matrix (based on markers in this
example) and create a optimum cross selection-based mating plan. The
idea is to restrict the levels of inbreeding, by means of the covariance
in the individual-cross level, and maximize the criterion used
(usefulness in this example). There is needed to set the target number
of crosses in the mating plan (<em>n.cross</em>), with the maximum and
minimum number of crosses that each parent can be part of
(<em>max.cross</em> and <em>min.cross</em>), together with the level of
covariance between cross via relationship matrix for the restriction
(<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># 1. Creating a relationship matrix from markers</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (lines_geno <span class="sc">%*%</span> <span class="fu">t</span>(lines_geno)) <span class="sc">/</span> <span class="fu">ncol</span>(lines_geno)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># 2. Generating the input for the optimization</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>MatingCrossesMT <span class="ot">&lt;-</span> <span class="fu">usef2Crosses</span>(<span class="at">Usefulness =</span> Multitrait_usef, <span class="at">K =</span> relMat)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co"># 3. Crosses selected</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> MatingCrossesMT[[<span class="dv">1</span>]],</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>                             <span class="at">K =</span> relMat,</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">10</span>,</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">3</span>,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="fl">0.8</span>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y  target.K</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; 1                0.8 2.830961 0.8638211</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="fu">head</span>(maxGainPlan[[<span class="dv">2</span>]], <span class="dv">10</span>)</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; 1       G1      G6 3.81037 0.7674797</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; 2       G1      G3 3.75425 0.7739837</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; 3       G1      G9 3.57558 0.7674797</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; 4       G2     G13 2.84712 0.7837398</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; 5       G2      G3 2.78391 0.7837398</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; 6       G2     G11 2.61696 0.7804878</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; 7       G6     G13 2.39689 0.7902439</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; 8       G3      G6 2.27204 0.7317073</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; 9      G13     G20 2.13137 0.7902439</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; 10      G6     G11 2.12112 0.7772358</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="pt3"></div>

</div>
<div id="optimization-usefulness-and-additivenon-additive-effects" class="section level2">
<h2>Optimization: Usefulness and additive/non-additive effects</h2>
<p>Here, we will create a mating plan based on usefulness for a trait
with additive and dominance effects.</p>
<p>We need the cross plan, with all individuals candidates to be
parents. We may use the function <code>planCross()</code> for doing so.
The parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getUsefAD()</code> to predict the
usefulness for each cross in the cross plan, using the markers, markers’
effects (additive marker effects and dominance marker effects), and the
genetic map. For this function, we may set the proportion of selection
individuals (<em>proSel</em>), the population type (<em>Type</em>), and
the generation (<em>Generation</em>).</p>
<p>There are two options for prediction of usefulness implemented in
<strong>SimpleMating</strong>. One of them are based on phased
haplotypes (basically a marker set where we know from each chromosome
the copy of the allele came from) (<em>Method = Phased</em>). The method
is a proposition that we implemented to estimate the usefulness without
the need for phased haplotypes (<em>Method = NonPhased</em>).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Loading the data</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">data</span>(generic_GenMap)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">data</span>(generic_geno)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">data</span>(generic_MrkEffects)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">data</span>(generic_Phasedgeno)</span></code></pre></div>
<p>Implementation</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># 1. Assigning the parents</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(generic_geno)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># 2. Creating the mating plan</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># 3.  Usefulness of trait number 1 - Phased</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>usef_Phased <span class="ot">&lt;-</span> <span class="fu">getUsefAD</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>                       <span class="at">Markers =</span> generic_Phasedgeno, <span class="co"># Phased haplotypes</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>                       <span class="at">addEff =</span> generic_MrkEffects[, <span class="dv">1</span>],</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>                       <span class="at">domEff =</span> generic_MrkEffects[, <span class="dv">3</span>],</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>                       <span class="at">Map.In =</span> generic_GenMap,</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>                       <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>                       <span class="at">Method =</span> <span class="st">&quot;Phased&quot;</span>)</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="fu">head</span>(usef_Phased, <span class="dv">10</span>)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt;     Cross.ID Parent1 Parent2 Total.gv       Var_A        sdA       Var_D</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; 1  1102_1359    1102    1359  2.52073 0.010897468 0.10439094 0.005482657</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; 2  1339_1359    1339    1359  2.45289 0.013280554 0.11524129 0.012402814</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; 3  1339_2033    1339    2033  2.34960 0.015543753 0.12467459 0.017127899</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; 4  1339_1347    1339    1347  2.29003 0.013437036 0.11591823 0.016549126</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; 5  2033_1143    2033    1143  2.12163 0.018176893 0.13482171 0.026884794</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; 6  2033_1434    2033    1434  2.04966 0.013492118 0.11615557 0.032066661</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt; 7  1102_1171    1102    1171  2.26128 0.003068254 0.05539183 0.009097601</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt; 8  1201_1171    1201    1171  2.26392 0.004158503 0.06448646 0.007595088</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; 9  1339_1310    1339    1310  2.13630 0.012048410 0.10976525 0.016511563</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; 10 2033_1359    2033    1359  2.10195 0.021062557 0.14512945 0.012271468</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt;           sdD Usefulness</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="co">#&gt; 1  0.07404497    2.78473</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co">#&gt; 2  0.11136792    2.78346</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co">#&gt; 3  0.13087360    2.72244</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co">#&gt; 4  0.12864341    2.64722</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co">#&gt; 5  0.16396583    2.55950</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="co">#&gt; 6  0.17907166    2.48994</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a><span class="co">#&gt; 7  0.09538134    2.48880</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co">#&gt; 8  0.08714980    2.48755</span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="co">#&gt; 9  0.12849733    2.48489</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="co">#&gt; 10 0.11077666    2.47855</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a><span class="co"># 3.  Usefulness of trait number 1 - Non phased</span></span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a>usefNonPhased <span class="ot">&lt;-</span> <span class="fu">getUsefAD</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a>                           <span class="at">Markers =</span> generic_geno, <span class="co"># non Phased haplotypes</span></span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a>                           <span class="at">addEff =</span> generic_MrkEffects[, <span class="dv">1</span>],</span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a>                           <span class="at">domEff =</span> generic_MrkEffects[, <span class="dv">3</span>],</span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a>                           <span class="at">Map.In =</span> generic_GenMap,</span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a>                           <span class="at">propSel =</span> <span class="fl">0.05</span>,</span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a>                           <span class="at">Method =</span> <span class="st">&quot;NonPhased&quot;</span>)</span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a><span class="co">#&gt; Usefulness predicted for 4950 crosses.</span></span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a><span class="fu">head</span>(usefNonPhased, <span class="dv">10</span>)</span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a><span class="co">#&gt;     Cross.ID Parent1 Parent2 Total.gv      Var_A       sdA     Var_D       sdD</span></span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a><span class="co">#&gt; 1  1102_1359    1102    1359  2.52073 0.07654957 0.2766759 0.7374415 0.8587441</span></span>
<span id="cb12-56"><a href="#cb12-56" tabindex="-1"></a><span class="co">#&gt; 2  2033_1733    2033    1733  2.00504 0.06875681 0.2622152 1.2068043 1.0985465</span></span>
<span id="cb12-57"><a href="#cb12-57" tabindex="-1"></a><span class="co">#&gt; 3  1339_1359    1339    1359  2.45289 0.08111153 0.2848009 0.7196356 0.8483134</span></span>
<span id="cb12-58"><a href="#cb12-58" tabindex="-1"></a><span class="co">#&gt; 4  1102_2033    1102    2033  2.05737 0.08955111 0.2992509 1.0478866 1.0236633</span></span>
<span id="cb12-59"><a href="#cb12-59" tabindex="-1"></a><span class="co">#&gt; 5  2033_1359    2033    1359  2.10195 0.06127579 0.2475395 0.9655286 0.9826131</span></span>
<span id="cb12-60"><a href="#cb12-60" tabindex="-1"></a><span class="co">#&gt; 6  1201_1171    1201    1171  2.26392 0.04039197 0.2009775 0.7898343 0.8887262</span></span>
<span id="cb12-61"><a href="#cb12-61" tabindex="-1"></a><span class="co">#&gt; 7  1102_2049    1102    2049  1.93103 0.08938496 0.2989732 1.0441306 1.0218271</span></span>
<span id="cb12-62"><a href="#cb12-62" tabindex="-1"></a><span class="co">#&gt; 8  1339_2033    1339    2033  2.34960 0.06744672 0.2597051 0.6720303 0.8197745</span></span>
<span id="cb12-63"><a href="#cb12-63" tabindex="-1"></a><span class="co">#&gt; 9  1201_2049    1201    2049  1.63507 0.08754122 0.2958737 1.2942936 1.1376703</span></span>
<span id="cb12-64"><a href="#cb12-64" tabindex="-1"></a><span class="co">#&gt; 10 2033_2049    2033    2049  1.97086 0.08199711 0.2863514 0.9300017 0.9643660</span></span>
<span id="cb12-65"><a href="#cb12-65" tabindex="-1"></a><span class="co">#&gt;    Usefulness</span></span>
<span id="cb12-66"><a href="#cb12-66" tabindex="-1"></a><span class="co">#&gt; 1     4.38174</span></span>
<span id="cb12-67"><a href="#cb12-67" tabindex="-1"></a><span class="co">#&gt; 2     4.33468</span></span>
<span id="cb12-68"><a href="#cb12-68" tabindex="-1"></a><span class="co">#&gt; 3     4.29870</span></span>
<span id="cb12-69"><a href="#cb12-69" tabindex="-1"></a><span class="co">#&gt; 4     4.25727</span></span>
<span id="cb12-70"><a href="#cb12-70" tabindex="-1"></a><span class="co">#&gt; 5     4.19212</span></span>
<span id="cb12-71"><a href="#cb12-71" tabindex="-1"></a><span class="co">#&gt; 6     4.14340</span></span>
<span id="cb12-72"><a href="#cb12-72" tabindex="-1"></a><span class="co">#&gt; 7     4.12713</span></span>
<span id="cb12-73"><a href="#cb12-73" tabindex="-1"></a><span class="co">#&gt; 8     4.12339</span></span>
<span id="cb12-74"><a href="#cb12-74" tabindex="-1"></a><span class="co">#&gt; 9     4.05982</span></span>
<span id="cb12-75"><a href="#cb12-75" tabindex="-1"></a><span class="co">#&gt; 10    4.04591</span></span></code></pre></div>
<p>The second part is using criterion for each cross (usefulness in this
example) together with a relationship matrix (based on markers in this
example) and create a optimum cross selection-based mating plan. The
idea is to restrict the levels of inbreeding, by means of the covariance
in the individual-cross level, and maximize the criterion used
(usefulness in this example). There is needed to set the target number
of crosses in the mating plan (<em>n.cross</em>), with the maximum and
minimum number of crosses that each parent can be part of
(<em>max.cross</em> and <em>min.cross</em>), together with the level of
covariance between cross via relationship matrix for the restriction
(<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned. Same step-by-step approach can be implemented for several
traits (using the function <code>getUsefAD_mt()</code>)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># 1. Relationship matrix</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (generic_geno <span class="sc">%*%</span> <span class="fu">t</span>(generic_geno)) <span class="sc">/</span> <span class="fu">ncol</span>(generic_geno)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># 1. Main table to be optimized</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>MatingCrosses <span class="ot">&lt;-</span> <span class="fu">usef2Crosses</span>(<span class="at">Usefulness =</span> usefNonPhased, <span class="at">K =</span> relMat) <span class="co"># Using the non phasing output</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co"># 2. Crosses selected</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> MatingCrosses[[<span class="dv">1</span>]],</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>                             <span class="at">K =</span> relMat,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">25</span>,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">10</span>,</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="dv">1</span>)</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y  target.K</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; 1                  1 3.994492 0.9576307</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt; 1     1102    1359 4.38174 0.9555556</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt; 2     2033    1733 4.33468 0.9013889</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#&gt; 3     1102    2033 4.25727 0.9548611</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt; 4     2033    1359 4.19212 0.9083333</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt; 5     1201    1171 4.14340 0.9090278</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt; 6     1102    2049 4.12713 0.9986111</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">#&gt; 7     1339    2033 4.12339 0.9034722</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="co">#&gt; 8     1201    2049 4.05982 0.9423611</span></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="co">#&gt; 9     2033    2049 4.04591 0.9743056</span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="co">#&gt; 10    2049    1310 4.00100 0.9402778</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="co">#&gt; 11    1201    1892 3.97605 0.9923611</span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="co">#&gt; 12    2033    1143 3.96836 0.8812500</span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a><span class="co">#&gt; 13    1339    1310 3.95119 0.9138889</span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a><span class="co">#&gt; 14    1201    1359 3.93565 0.9256944</span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a><span class="co">#&gt; 15    2033    1171 3.93248 0.9416667</span></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a><span class="co">#&gt; 16    1359    2049 3.91438 0.9125000</span></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a><span class="co">#&gt; 17    1102    1171 3.90924 0.9451389</span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a><span class="co">#&gt; 18    1339    1733 3.89186 0.8555556</span></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a><span class="co">#&gt; 19    2049    1171 3.88915 0.9375000</span></span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a><span class="co">#&gt; 20    1359    1310 3.87246 0.9201389</span></span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a><span class="co">#&gt; 21    2033    1434 3.85634 0.8951389</span></span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a><span class="co">#&gt; 22    1201    1339 3.81435 0.9201389</span></span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a><span class="co">#&gt; 23    1733    1359 3.76770 0.9208333</span></span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a><span class="co">#&gt; 24    1359    1143 3.75900 0.9493056</span></span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a><span class="co">#&gt; 25    1359    2021 3.75762 0.9243056</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="pt4"></div>


</div>
<div id="optimization-using-total-genetic-value" class="section level2">
<h2>Optimization: Using total genetic value</h2>
<p>Here, we will create a mating plan through an optimization based on
total genetic value for one trait controlled by additive and dominance
effects, using molecular markers.</p>
<p>We need the cross plan, with all individuals candidates to parents.
We may use the function <code>planCross()</code> for doing so. The
parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). The upcoming
step is to use the function <code>getTGV()</code> to predict the total
genetic value for each cross in the cross plan, using the markers,
markers’ effects, and the relationship matrix for generating the input
for the new optimization function itself.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Loading the data</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">data</span>(generic_GenMap)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">data</span>(generic_geno)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="fu">data</span>(generic_MrkEffects)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="fu">data</span>(generic_geno)</span></code></pre></div>
<p>Implementation</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># 1. Creating relationship matrix based on markers</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>relMat <span class="ot">&lt;-</span> (generic_geno <span class="sc">%*%</span> <span class="fu">t</span>(generic_geno)) <span class="sc">/</span> <span class="fu">ncol</span>(generic_geno)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># 2. Assigning parents</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(generic_geno)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co"># 3. Creating the mating plan</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>Cross_plan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>                        <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co"># 4. Estimates the total genetic value for the progenies of each cross</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>total_gv <span class="ot">&lt;-</span> <span class="fu">getTGV</span>(<span class="at">MatePlan =</span> Cross_plan,</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>                    <span class="at">Markers =</span> generic_geno,</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>                    <span class="at">addEff =</span> generic_MrkEffects[, <span class="dv">1</span>],</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>                    <span class="at">domEff =</span> generic_MrkEffects[, <span class="dv">3</span>],</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>                    <span class="at">K =</span> relMat)</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt; TGVs predicted for 4950 crosses.</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="fu">head</span>(total_gv, <span class="dv">10</span>)</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2        Y         K</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt; 1     1053    1054  0.90863 1.0576389</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="co">#&gt; 2     1053    1079 -0.83714 0.9298611</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a><span class="co">#&gt; 3     1053    1086 -1.27929 0.9152778</span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a><span class="co">#&gt; 4     1053    1088 -0.82665 0.9416667</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a><span class="co">#&gt; 5     1053    1094  0.55338 0.9548611</span></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a><span class="co">#&gt; 6     1053    1106 -0.16536 0.9333333</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a><span class="co">#&gt; 7     1053    1107  0.25197 0.9944444</span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a><span class="co">#&gt; 8     1053    1115  0.45575 0.9006944</span></span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a><span class="co">#&gt; 9     1053    1136 -0.54217 0.9305556</span></span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a><span class="co">#&gt; 10    1053    1155 -0.60381 0.9000000</span></span></code></pre></div>
<p>The second part is using criterion for each cross (total genetic
value in this example) together with a relationship matrix (based on
markers in this example) and create a optimum cross selection-based
mating plan. The idea is to restrict the levels of inbreeding, by means
of the covariance in the individual-cross level, and maximize the
criterion used (total genetic value in this example). There is needed to
set the target number of crosses in the mating plan (<em>n.cross</em>),
with the maximum and minimum number of crosses that each parent can be
part of (<em>max.cross</em> and <em>min.cross</em>), together with the
level of covariance between cross via relationship matrix for the
restriction (<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co"># 1. Crosses selected</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> total_gv,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                             <span class="at">K =</span> relMat,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">25</span>,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">10</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="dv">1</span>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y  target.K</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; 1                  1 2.047886 0.9499303</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt;    Parent1 Parent2       Y         K</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; 1     1102    1359 2.52073 0.9555556</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; 2     1339    2033 2.34960 0.9034722</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; 3     1339    1347 2.29003 0.9659722</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; 4     1201    1171 2.26392 0.9090278</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; 5     1102    1171 2.26128 0.9451389</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; 6     1339    1310 2.13630 0.9138889</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; 7     2033    1143 2.12163 0.8812500</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt; 8     2033    1171 2.11166 0.9416667</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="co">#&gt; 9     2033    1359 2.10195 0.9083333</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co">#&gt; 10    1339    1171 2.06681 0.8979167</span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co">#&gt; 11    1102    2033 2.05737 0.9548611</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="co">#&gt; 12    1201    1892 2.05191 0.9923611</span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a><span class="co">#&gt; 13    2033    1434 2.04966 0.8951389</span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="co">#&gt; 14    2033    1733 2.00504 0.9013889</span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="co">#&gt; 15    2033    2049 1.97086 0.9743056</span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a><span class="co">#&gt; 16    1102    1339 1.94544 0.9673611</span></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="co">#&gt; 17    1359    1892 1.94445 0.9048611</span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a><span class="co">#&gt; 18    1102    2049 1.93103 0.9986111</span></span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a><span class="co">#&gt; 19    1339    1237 1.91473 0.9034722</span></span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a><span class="co">#&gt; 20    1339    1733 1.90448 0.8555556</span></span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a><span class="co">#&gt; 21    1201    1339 1.87760 0.9201389</span></span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a><span class="co">#&gt; 22    1102    2040 1.84842 0.9423611</span></span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a><span class="co">#&gt; 23    2033    1781 1.83148 0.9145833</span></span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a><span class="co">#&gt; 24    1102    1427 1.82140 0.9986111</span></span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a><span class="co">#&gt; 25    2033    1427 1.81936 0.9368056</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="pt5"></div>

</div>
<div id="optimization-using-the-mean-parental-average" class="section level2">
<h2>Optimization: Using the Mean Parental Average</h2>
<p>Here, we will create a mating plan through an optimization based on
the mean parental average for one additive trait using pedigree
information.</p>
<p>We need the cross plan, with all individuals candidates to parents.
We may use the function <code>planCross()</code> for doing so. The
parents are all individuals genotyped (<em>TargetPop</em>). We may
choose which mate design we want (<em>MateDesign</em>). Then, we need to
organized the dataset for the predictions. Basically, the input to
calculate the mean parental average is a two column data frame, where in
the first row we have the individuals identification (same names that we
find in the cross plan), and the criterion. By criterion you can
specified the estimated breeding value (ebv) or even the best linear
unbiased prediction (BLUP) for each individuals. This allow us to use
this function for poliploids individuals, for example. In this case, we
can make the predictions and input the values to calculate the expected
mean parental average for each cross.</p>
<p>The upcoming step is to use the function <code>getMPA()</code> to
predict the mean parental average for each cross in the cross plan,
using the BLUP information from each individual. The relationship matrix
based on pedigree (in this case) is used to restrict for inbreeding. You
can use the relationship matrix based on markers as well, instead of the
pedigree-based matrix. We will use the package
<strong>AGHmatrix</strong> for that (Amadeu et al. 2022).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">require</span>(SimpleMating)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co"># 1. Loading the information</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">data</span>(generic_pedigree)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">data</span>(generic_IndBLUP)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">data</span>(generic_geno)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co"># 2. Using AGHMatrix to build the G matrix</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>AMat <span class="ot">&lt;-</span> AGHmatrix<span class="sc">::</span><span class="fu">Amatrix</span>(<span class="at">data =</span> generic_pedigree)</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; Verifying conflicting data... </span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt; Organizing data... </span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; Your data was chronologically organized with success. </span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; Constructing matrix A using ploidy = 2 </span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; Completed! Time = 0  minutes</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co"># 3. Assigning parents</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>Parents <span class="ot">&lt;-</span> <span class="fu">rownames</span>(generic_geno)</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co"># 4. Creating the mating plan</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a>CrossPlan <span class="ot">&lt;-</span> <span class="fu">planCross</span>(<span class="at">TargetPop =</span> Parents,</span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>                       <span class="at">MateDesign =</span> <span class="st">&quot;half&quot;</span>)</span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a><span class="co">#&gt; Number of crosses generated: 4950</span></span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="co"># 5. Criterion</span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a>Crit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Id =</span> <span class="fu">rownames</span>(generic_geno),</span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a>                   <span class="at">Criterion =</span> generic_IndBLUP[, <span class="dv">2</span>])</span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a><span class="co"># 6.Single trait mean parental average</span></span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a>ST_mpa <span class="ot">&lt;-</span> <span class="fu">getMPA</span>(<span class="at">MatePlan =</span> CrossPlan,</span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a>                 <span class="at">Criterion =</span> Crit,</span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a>                 <span class="at">K =</span> AMat)</span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a><span class="co">#&gt; 4950 possible crosses were predicted</span></span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a><span class="fu">head</span>(ST_mpa, <span class="dv">20</span>)</span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a><span class="co">#&gt;    Parent2        Y    K</span></span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a><span class="co">#&gt; 1     1932 30.72485 0.00</span></span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a><span class="co">#&gt; 2     1932 28.84817 0.00</span></span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a><span class="co">#&gt; 3     1932 28.60022 0.00</span></span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a><span class="co">#&gt; 4     1932 28.51432 0.00</span></span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a><span class="co">#&gt; 5     1932 28.46620 0.25</span></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a><span class="co">#&gt; 6     1186 28.31395 0.00</span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a><span class="co">#&gt; 7     1932 28.27448 0.00</span></span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a><span class="co">#&gt; 8     1932 28.22789 0.00</span></span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a><span class="co">#&gt; 9     1932 28.10999 0.00</span></span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a><span class="co">#&gt; 10    1186 28.06600 0.00</span></span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a><span class="co">#&gt; 11    1932 28.02621 0.00</span></span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a><span class="co">#&gt; 12    1186 27.98010 0.00</span></span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a><span class="co">#&gt; 13    1932 27.95431 0.00</span></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a><span class="co">#&gt; 14    1186 27.93198 0.00</span></span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a><span class="co">#&gt; 15    1932 27.85829 0.00</span></span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a><span class="co">#&gt; 16    1186 27.74026 0.00</span></span>
<span id="cb19-52"><a href="#cb19-52" tabindex="-1"></a><span class="co">#&gt; 17    1186 27.69367 0.00</span></span>
<span id="cb19-53"><a href="#cb19-53" tabindex="-1"></a><span class="co">#&gt; 18    1186 27.57577 0.00</span></span>
<span id="cb19-54"><a href="#cb19-54" tabindex="-1"></a><span class="co">#&gt; 19    1186 27.49199 0.00</span></span>
<span id="cb19-55"><a href="#cb19-55" tabindex="-1"></a><span class="co">#&gt; 20    1186 27.42009 0.00</span></span></code></pre></div>
<p>The second part is using criterion for each cross (mean parental
average in this example) together with a relationship matrix (based on
pedigree information in this example) and create a optimum cross
selection-based mating plan. The idea is to restrict the levels of
inbreeding, by means of the covariance in the individual-cross level,
and maximize the criterion used (mean parental average in this example).
There is needed to set the target number of crosses in the mating plan
(<em>n.cross</em>), with the maximum and minimum number of crosses that
each parent can be part of (<em>max.cross</em> and <em>min.cross</em>),
together with the level of covariance between cross via relationship
matrix for the restriction (<em>culling.pairwise.k</em>).</p>
<p>The output will be the mating plan based on the parameters before
mentioned.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># 1. Crosses selected</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>maxGainPlan <span class="ot">&lt;-</span> <span class="fu">selectCrosses</span>(<span class="at">data =</span> ST_mpa,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                             <span class="at">K =</span> AMat,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                             <span class="at">n.cross =</span> <span class="dv">25</span>,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>                             <span class="at">max.cross =</span> <span class="dv">10</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                             <span class="at">min.cross =</span> <span class="dv">1</span>,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>                             <span class="at">culling.pairwise.k =</span> <span class="fl">0.4</span>)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co"># Crosses parameters</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>maxGainPlan[[<span class="dv">1</span>]]</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt;   culling.pairwise.k target.Y target.K</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt; 1                0.4 28.00887      0.5</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co"># Mating Plan</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>maxGainPlan[[<span class="dv">2</span>]]</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co">#&gt;    Parent2        Y    K</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co">#&gt; 1     1932 30.72485 0.00</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co">#&gt; 2     1932 28.84817 0.00</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="co">#&gt; 3     1932 28.60022 0.00</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co">#&gt; 4     1932 28.51432 0.00</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co">#&gt; 5     1932 28.46620 0.25</span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="co">#&gt; 6     1186 28.31395 0.00</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="co">#&gt; 7     1932 28.27448 0.00</span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co">#&gt; 8     1932 28.22789 0.00</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="co">#&gt; 9     1932 28.10999 0.00</span></span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a><span class="co">#&gt; 10    1186 28.06600 0.00</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a><span class="co">#&gt; 11    1932 28.02621 0.00</span></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co">#&gt; 12    1186 27.98010 0.00</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="co">#&gt; 13    1932 27.95431 0.00</span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a><span class="co">#&gt; 14    1186 27.93198 0.00</span></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="co">#&gt; 15    1932 27.85829 0.00</span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a><span class="co">#&gt; 16    1186 27.74026 0.00</span></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co">#&gt; 17    1186 27.69367 0.00</span></span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a><span class="co">#&gt; 18    1186 27.57577 0.00</span></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a><span class="co">#&gt; 19    1186 27.49199 0.00</span></span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a><span class="co">#&gt; 20    1186 27.42009 0.00</span></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a><span class="co">#&gt; 21    1932 27.38937 0.00</span></span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a><span class="co">#&gt; 22    1186 27.32407 0.00</span></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a><span class="co">#&gt; 23    1932 27.30411 0.00</span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a><span class="co">#&gt; 24    1932 27.26830 0.00</span></span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a><span class="co">#&gt; 25    1932 27.11706 0.00</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>maxGainPlan[[<span class="dv">3</span>]]</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="bibliography" class="section level2">
<h2>Bibliography</h2>
<p>Akdemir &amp; Sánchez (2016). Efficient breeding by genomic mating.
Frontiers in Genetics. <a href="https://doi.org/10.3389/fgene.2016.00210" class="uri">https://doi.org/10.3389/fgene.2016.00210</a><br />
Allier et al. (2019). Usefulness criterion and post-selection parental
contributions in multi-parental crosses: Application to polygenic trait
introgression. G3: Genes, Genomes, Genetics. <a href="https://doi.org/10.1534/g3.119.400129" class="uri">https://doi.org/10.1534/g3.119.400129</a><br />
Bonk et al. (2016). Mendelian sampling covariability of marker effects
and genetic values. Genetics Selection Evolution. <a href="https://gsejournal.biomedcentral.com/articles/10.1186/s12711-016-0214-0" class="uri">https://gsejournal.biomedcentral.com/articles/10.1186/s12711-016-0214-0</a><br />
Lehermeier (2017). Genetic gain increases by applying the usefulness
criterion with improved variance prediction in selection of crosses.
Genetics. <a href="https://doi.org/10.1534/genetics.117.300403" class="uri">https://doi.org/10.1534/genetics.117.300403</a><br />
Schnell &amp; Utz (1976). F1 Leistung und Elternwahl in der Zuchtung von
Selbstbefruchtern. Ber Arbeitstag Arbeitsgem Saatzuchtleiter.<br />
Toro &amp; Varona (2010). A note on mate allocation for dominance
handling in genomic selection. Genetics Selection Evolution. <a href="https://doi.org/10.1186/1297-9686-42-33" class="uri">https://doi.org/10.1186/1297-9686-42-33</a><br />
Varona et al. (2018). Non-additive effects in genomic selection.
Frontiers in Genetics. <a href="https://doi.org/10.3389/fgene.2018.00078" class="uri">https://doi.org/10.3389/fgene.2018.00078</a><br />
Wolfe et al. (2021). Genomic mating in outbred species: Predicting cross
usefulness with additive and total genetic covariance matrices.
Genetics. <a href="https://doi.org/10.1093/genetics/iyab122" class="uri">https://doi.org/10.1093/genetics/iyab122</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
